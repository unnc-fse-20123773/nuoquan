(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index","components/articlebrief"],{"0448":function(t,e,i){},"1fb5":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement;t._self._c},r=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return r})},2917:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=(t._self._c,t._f("timeDeal")(t.thisArticle.createDate));t.$mp.data=Object.assign({},{$root:{f0:i}})},r=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return r})},3971:function(t,e,i){"use strict";i.r(e);var n=i("d441"),r=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);e["default"]=r.a},"41d1":function(t,e,i){"use strict";i.r(e);var n=i("2917"),r=i("8e5e");for(var s in r)"default"!==s&&function(t){i.d(e,t,function(){return r[t]})}(s);i("bdf1"),i("b817");var a=i("2877"),o=Object(a["a"])(r["default"],n["a"],n["b"],!1,null,"2de2ed9f",null);e["default"]=o.exports},4550:function(t,e,i){"use strict";i.r(e);var n=i("1fb5"),r=i("3971");for(var s in r)"default"!==s&&function(t){i.d(e,t,function(){return r[t]})}(s);i("6676"),i("c25b");var a=i("2877"),o=Object(a["a"])(r["default"],n["a"],n["b"],!1,null,"7961efd9",null);e["default"]=o.exports},4884:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={name:"aticlebrief",props:{articleCard:{}},data:function(){return{serverUrl:this.$serverUrl,userInfo:this.getGlobalUserInfo(),singleImgHeight:0,singleImgWidth:0,heightWidthRate:0,imgList:[],thisArticle:this.articleCard,tagColorList:[]}},created:function(){var e=this;if(this.thisArticle.imgList.length>3)for(var i=0;i<3;i++)this.imgList.push(this.thisArticle.imgList[i]);else this.imgList=this.thisArticle.imgList;if(!this.isNull(this.thisArticle.tagList)){var n=this.tagColors;for(i=0;i<this.thisArticle.tagList.length;i++){var r=Math.floor(Math.random()*n.length);this.tagColorList.push(n[r])}}t.$on("updateArticle",function(t){t.id==e.thisArticle.id&&(console.log("get"),e.thisArticle=t)})},filters:{timeDeal:function(t){t=new Date(t);var e,i=[t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds()],n=t.getTime(),r=new Date,s=r.getTime(),a=0;return a=s-n,e=a<=6e4?"刚刚":6e4<a&&a<=36e5?Math.round(a/6e4)+"分钟前":36e5<a&&a<=864e5?Math.round(a/36e5)+"小时前":864e5<a&&a<=1296e6?Math.round(a/864e5)+"天前":a>1296e6&&i[0]==r.getFullYear()?i[1]+"-"+i[2]+" "+i[3]+":"+i[4]:i[0]+"-"+i[1]+"-"+i[2]+" "+i[3]+":"+i[4],e}},methods:{singleImgeFit:function(t){var e,i=t.detail.height,n=t.detail.width;i>=n?(this.singleImgState=0,this.singleImgHeight=400,e=n/i,this.heightWidthRate=e,this.singleImgWidth=400*e):(this.singleImgState=1,this.singleImgWidth=400,e=i/n,this.heightWidthRate=e,this.singleImgHeight=400*e)},swLikeArticle:function(){this.thisArticle.isLike?(this.unLikeArticle(),this.thisArticle.likeNum--):(this.likeArticle(),this.thisArticle.likeNum++),this.thisArticle.isLike=!this.thisArticle.isLike},likeArticle:function(){console.log("点赞文章");var e=this;t.request({method:"POST",url:e.$serverUrl+"/article/userLikeArticle",data:{userId:e.userInfo.id,articleId:e.thisArticle.id,articleCreaterId:e.thisArticle.userId},header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){console.log(t)}})},unLikeArticle:function(){console.log("取消点赞文章");var e=this;t.request({method:"POST",url:e.$serverUrl+"/article/userUnLikeArticle",data:{userId:e.userInfo.id,articleId:e.thisArticle.id,articleCreaterId:e.thisArticle.userId},header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){console.log(t)}})},jumpToDetail:function(){var e=JSON.stringify(this.thisArticle);t.navigateTo({url:"/pages/detail/detail?data="+e})},goToPersonPublic:function(e){t.navigateTo({url:"/pages/personpublic/personpublic?userId="+e})},previewImage:function(e){for(var i,n=this.thisArticle.imgList,r=[],s=0;s<n.length;s++)i=this.serverUrl+n[s].imagePath,r=r.concat(i);t.previewImage({current:e,urls:r})}}};e.default=i}).call(this,i("543d")["default"])},6676:function(t,e,i){"use strict";var n=i("6aba"),r=i.n(n);r.a},"6aba":function(t,e,i){},"8e5e":function(t,e,i){"use strict";i.r(e);var n=i("4884"),r=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);e["default"]=r.a},"8ea2":function(t,e,i){},"9dfd":function(t,e,i){},b817:function(t,e,i){"use strict";var n=i("0448"),r=i.n(n);r.a},bdf1:function(t,e,i){"use strict";var n=i("9dfd"),r=i.n(n);r.a},c25b:function(t,e,i){"use strict";var n=i("8ea2"),r=i.n(n);r.a},d441:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(i("41d1"));i("2f62");function r(t){return t&&t.__esModule?t:{default:t}}var s=function(){return i.e("components/mainpagetop").then(i.bind(null,"8c83"))},a=function(){return i.e("components/mainpageleft").then(i.bind(null,"f49b"))},o=!1,l={data:function(){return{title:"Hello",hottitlelist:["热门标题111","热门标题222","热门标题333"],showlist:[],topArticles:"",topHeight:"160",userInfo:{id:"test-id123",nickname:"test-name",faceImg:"",faceImgThumb:"",email:"zy22089@nottingham.edu.cn",emailPrefix:"zy22089",emailSuffix:"@nottingham.edu.cn"},totalPage:1,currentPage:1}},components:{articlebrief:n.default,mainpagetop:s,mainpageleft:a},onLoad:function(){var e=this,i=this.getGlobalUserInfo();if(this.isNull(i))t.redirectTo({url:"../signin/signin"});else{this.userInfo=i,this.mySocket.init();var n=this.currentPage;this.showArticles(n),t.$on("flash",function(){e.refreshArticle()})}},onUnload:function(){t.$off("flash")},onShow:function(){var t=this.getGlobalUserInfo();this.isNull(t)||this.queryUserInfo(t.id),this.getTop3Articles()},methods:{showArticles:function(e){if(!o){o=!0,t.showLoading({title:"加载中..."});var i=this;t.request({url:i.$serverUrl+"/article/queryAllArticles",method:"POST",data:{page:e,userId:i.userInfo.id},header:{"content-type":"application/x-www-form-urlencoded"},success:function(n){setTimeout(function(){t.hideLoading(),o=!1,console.log(n),1==e&&(i.showlist=[]);var r=n.data.data.rows,s=i.showlist;i.showlist=s.concat(r),i.currentPage=e,i.totalPage=n.data.data.total},300)},fail:function(e){t.hideLoading(),o=!1,console.log("index unirequest fail"),console.log(e)}})}},loadMore:function(){var e=this,i=e.currentPage;console.log(i);var n=e.totalPage;if(console.log(n),i==n)t.showToast({title:"没有更多文章了",icon:"none",duration:1e3});else{var r=i+1;e.showArticles(r)}},refreshArticle:function(){t.showNavigationBarLoading(),this.showArticles(1),t.hideNavigationBarLoading()},getTop3Articles:function(){var e=this;t.request({url:e.$serverUrl+"/article/getHotTop3",method:"POST",data:{userId:e.userInfo.id},header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){e.topArticles=t.data.data}})},queryUserInfo:function(e){var i=this,n=this;t.request({url:n.$serverUrl+"/user/queryUser",method:"POST",data:{userId:e},header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){if(200==t.data.status){var e=t.data.data,n=i.myUser(e);i.setGlobalUserInfo(n),i.userInfo=n}}})},linkageWithTop:function(t){var e=t.detail.scrollTop;this.topHeight>=36&&(this.topHeight=160-e>=36?160-e:36)}}};e.default=l}).call(this,i("543d")["default"])}},[["854a","common/runtime","common/vendor"]]]);