(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/messagelist/messagelist"],{"1e29":function(t,e,s){"use strict";var i=s("5c65"),n=s.n(i);n.a},"5c65":function(t,e,s){},"6b94":function(t,e,s){"use strict";var i=s("ffc3"),n=s.n(i);n.a},"8bf5":function(t,e,s){"use strict";s.r(e);var i=s("f62d"),n=s.n(i);for(var a in i)"default"!==a&&function(t){s.d(e,t,function(){return i[t]})}(a);e["default"]=n.a},9554:function(t,e,s){"use strict";s.r(e);var i=s("b477"),n=s.n(i);for(var a in i)"default"!==a&&function(t){s.d(e,t,function(){return i[t]})}(a);e["default"]=n.a},b477:function(t,e,s){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s={name:"swipe-action",props:{messagesList:""},data:function(){var t="Uni_".concat(Math.ceil(1e6*Math.random()).toString(36));return{elId:t,transformX:"translateX(0px)",messageIndex:-1,showdelete:0,READ:this.chat.READ,UNREAD:this.chat.UNREAD}},created:function(){this.direction="",this.startX=0,this.startY=0,this.btnGroupWidth=0,this.isMoving=!1},onReady:function(){},methods:{toMessageDetail:function(e,s){2==s?(console.log("进入到聊天界面"+e),t.navigateTo({url:"../message_info/message_info"})):1==s&&console.log("进入系统消息界面"+e)},bindClickBtn:function(t,e){this.messageIndex=-1,console.log(t.text+"message第"+e+"项")},touchStart:function(t){!0!==t.currentTarget.dataset.disabled&&(this.startX=t.touches[0].pageX,this.startY=t.touches[0].pageY)},touchMove:function(t){if("Y"!==this.direction&&!0!==t.currentTarget.dataset.disabled){var e=t.touches[0].pageY-this.startY,s=-(t.touches[0].pageX-this.startX);!this.isMoving&&Math.abs(e)>Math.abs(s)||Math.abs(e)>100||Math.abs(s)<50?this.direction="Y":(console.log(s),this.direction=s>0?"right":"left",console.log(this.direction),this.messageIndex=s<0?t.currentTarget.dataset.index:-1,this.isMoving=!0)}else this.direction=""},touchEnd:function(t){this.isMoving=!1,"right"===this.direction||"left"===this.direction?("right"==this.direction&&(this.messageIndex=-1),console.log(this.messageIndex),this.endMove(t)):this.direction=""},endMove:function(t){"Y"!==this.direction&&!0!==t.currentTarget.dataset.disabled?(-1!==this.messageIndex?(this.transformX="translateX(".concat(58,"px)"),this.$emit("opened"),this.showdelete=1):(this.transformX="translateX(0px)",this.$emit("closed"),this.showdelete=0),this.direction=""):this.direction=""},tapCard:function(t){this.$emit("tapCard",t)},tapDelete:function(t){this.$emit("tapDelete",t),this.showdelete=0,this.transformX="translateX(0px)"}}};e.default=s}).call(this,s("6e42")["default"])},b54f:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",{staticClass:"message-list"},t._l(t.messagesList,function(e,i){return s("block",{key:i},[s("view",{staticClass:"uni-swipe-action",staticStyle:{height:"138rpx"}},[1==t.showdelete&&t.messageIndex==i?s("view",{staticClass:"delete-button super_center",attrs:{eventid:"49471902-0-"+i},on:{tap:function(s){t.tapDelete(e)}}},[s("text",{staticStyle:{color:"white","text-align":"center","font-size":"small"}},[t._v("删除")])]):t._e(),s("view",{staticClass:"uni-swipe-action__container",staticStyle:{width:"88%","margin-left":"6%","margin-top":"12rpx",height:"120rpx","background-color":"white"},style:{transform:t.messageIndex==i?t.transformX:"translateX(0px)","-webkit-transform":t.messageIndex==i?t.transformX:"translateX(0px)","box-shadow":e.isRead==t.UNREAD?"0upx 0upx 12upx 1upx #D1D1D1":""},attrs:{"data-index":i,"data-disabled":e.disabled,eventid:"49471902-3-"+i},on:{touchstart:t.touchStart,touchmove:t.touchMove,touchend:t.touchEnd,touchcancel:t.touchEnd}},[s("view",{staticClass:"uni-swipe-action__content ",attrs:{eventid:"49471902-2-"+i},on:{click:function(s){t.toMessageDetail(i,e.type)}}},[s("view",{staticClass:"item",class:e.stick?"stick":"",attrs:{eventid:"49471902-1-"+i},on:{tap:function(s){t.tapCard(e)}}},[s("block",[s("view",{staticClass:"item-left"},[s("view",{staticClass:"avator"},[s("image",{staticClass:"img",attrs:{src:e.friendInfo.faceImg}})])]),s("view",{staticClass:"item-middle"},[s("text",{class:e.isRead==t.UNREAD?"title":"title-read"},[t._v(t._s(e.friendInfo.nickname))]),s("text",{class:e.isRead==t.UNREAD?"message":"message-read"},[t._v(t._s(e.msg))])]),s("view",{staticClass:"item-right"},[s("view",{staticClass:"time"},[t._v(t._s(e.createDate))]),e.isRead==t.UNREAD?s("view",{staticClass:"mark"},[t._v(t._s(e.count))]):t._e()])])],1)])])])])}))},n=[];s.d(e,"a",function(){return i}),s.d(e,"b",function(){return n})},baa5:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",{attrs:{id:"container"}},[s("view",{attrs:{id:"msglist-yellowshadowbg"}}),s("view",{attrs:{id:"msglist-yellowbg"}}),s("view",{attrs:{id:"msglist-likecommentnum"}},[s("view",{staticClass:"msglist-like column_center",attrs:{eventid:"5e3ff870-0"},on:{tap:function(e){t.goToCmtLikeDetail(0)}}},[t._m(0),s("text",{staticClass:"msglist-like-text font-family"},[t._v("点赞")]),t.uLikeMsgCount>0?s("view",{class:[t.uLikeMsgCount>9?"msglist-like-num-2 super_center":"msglist-like-num-1 super_center"]},[t._v(t._s(t.uLikeMsgCount))]):t._e()]),s("view",{staticClass:"msglist-likecommentnum-border"}),s("view",{staticClass:"msglist-comment column_center",attrs:{eventid:"5e3ff870-1"},on:{tap:function(e){t.goToCmtLikeDetail(1)}}},[t._m(1),s("text",{staticClass:"msglist-comment-text font-family"},[t._v("评论")]),t.uCommentMsgCount>0?s("view",{class:[t.uCommentMsgCount>9?"msglist-comment-num-2 super_center":"msglist-comment-num-1 super_center"]},[t._v(t._s(t.uCommentMsgCount))]):t._e()]),s("scroll-view",{staticStyle:{position:"fixed",left:"0rpx",top:"314rpx",width:"100%",height:"1132rpx"},attrs:{"scroll-y":"true"}},[s("view",[s("view",{staticClass:"message-list"},[s("swipe-action",{attrs:{options:t.options,messagesList:t.chatSnapShotList,eventid:"5e3ff870-2",mpcomid:"5e3ff870-0"},on:{tapCard:function(e){t.goToChatpage()},tapDelete:function(e){t.deleteChat()}}})],1)])])],1)])},n=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",{staticClass:"msglist-like-bg super_center"},[s("image",{staticClass:"msglist-like-icon",attrs:{src:"../../static/icon/like.png",mode:""}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",{staticClass:"msglist-comment-bg super_center"},[s("image",{staticClass:"msglist-comment-icon",attrs:{src:"../../static/icon/comment.png",mode:""}})])}];s.d(e,"a",function(){return i}),s.d(e,"b",function(){return n})},be57:function(t,e,s){"use strict";s.r(e);var i=s("baa5"),n=s("8bf5");for(var a in n)"default"!==a&&function(t){s.d(e,t,function(){return n[t]})}(a);s("1e29");var o=s("2877"),r=Object(o["a"])(n["default"],i["a"],i["b"],!1,null,null,null);e["default"]=r.exports},dfc8:function(t,e,s){"use strict";s.r(e);var i=s("b54f"),n=s("9554");for(var a in n)"default"!==a&&function(t){s.d(e,t,function(){return n[t]})}(a);s("6b94");var o=s("2877"),r=Object(o["a"])(n["default"],i["a"],i["b"],!1,null,null,null);e["default"]=r.exports},f34c:function(t,e,s){"use strict";s("5ad9");var i=a(s("b0ce")),n=a(s("be57"));function a(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(n.default))},f62d:function(t,e,s){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,n=s("2f62"),a=o(s("dfc8"));function o(t){return t&&t.__esModule?t:{default:t}}function r(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{},i=Object.keys(s);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(t){return Object.getOwnPropertyDescriptor(s,t).enumerable}))),i.forEach(function(e){c(t,e,s[e])})}return t}function c(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var l={components:{swipeAction:a.default},data:function(){return{focus:!1,isShowView:!0,msgicon:[],chatSnapShotList:"",READ:this.chat.READ,UNREAD:this.chat.UNREAD,uLikeMsgCount:t.getStorageSync("likeMsgCount"),uCommentMsgCount:t.getStorageSync("commentMsgCount")}},computed:r({},(0,n.mapState)(["chatMessageCard","likeMsgCount","commentMsgCount"])),watch:{chatMessageCard:function(t,e){this.loadingChatSnapshot()},likeMsgCount:function(t,e){this.uLikeMsgCount=t},commentMsgCount:function(t,e){this.uCommentMsgCount=t}},onLoad:function(){t.setNavigationBarTitle({title:"消息列表"}),i=this.getGlobalUserInfo(),this.isNull(i)&&console.log("No userInfo!!")},onShow:function(){this.loadingChatSnapshot()},methods:{loadingChatSnapshot:function(){var e=this.chat.getUserChatSnapShot(i.id);this.chatSnapShotList=e;var s=0,n=0;console.log(e);for(var a=0;a<e.length;a++){var o=e[a].friendId,r=this.getUserInfoFromUserList(o);if(this.isNull(r)){s++;var c=this;t.request({url:c.$serverUrl+"/user/queryUser",method:"POST",data:{userId:o},header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){200==t.data.status&&(r=t.data.data,c.setUserInfoToUserList(r),n++,console.log("sendCount="+s+" receiveCount="+n),s==n&&c.loadingChatSnapshot())}})}else e[a].friendInfo=r}},deleteChat:function(t){var e=t.friendId;this.chat.deletUserChatHistory(i.id,e),this.chat.deletUserChatSnapShot(i.id,e),this.loadingChatSnapshot()},goToChatpage:function(e){var s=e.myId,i=e.friendId,n=(e.msg,e.friendInfo);this.chat.readUserChatSnapShot(s,i),t.navigateTo({url:"../chatpage/chatpage?friendInfo="+JSON.stringify(n)})},goToCmtLikeDetail:function(e){0==e?this.$store.commit("setLikeMsgCount",0):this.$store.commit("setCommentMsgCount",0),t.navigateTo({url:"../cmt-likedetail/cmt-likedetail?currentTab="+JSON.stringify(e)})}}};e.default=l}).call(this,s("6e42")["default"])},ffc3:function(t,e,s){}},[["f34c","common/runtime","common/vendor"]]]);