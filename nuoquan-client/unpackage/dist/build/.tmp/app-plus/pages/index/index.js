(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"0964":function(t,e,i){"use strict";i.r(e);var o=i("b665"),a=i.n(o);for(var n in o)"default"!==n&&function(t){i.d(e,t,function(){return o[t]})}(n);e["default"]=a.a},"0bba":function(t,e,i){},"0de0":function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{staticClass:"index"},[i("mainpagetop",{staticStyle:{position:"fixed","z-index":"30",height:"100%"},attrs:{userInfo:t.userInfo,topArticles:t.topArticles,topHeight:t.topHeight,mpcomid:"4d8a9a0a-0"}}),i("view",{staticClass:"indexSelf",staticStyle:{height:"100%"}},[i("scroll-view",{staticClass:"indexArticleArea",attrs:{"scroll-y":"true","upper-threshold":"5",eventid:"4d8a9a0a-0"},on:{scroll:t.linkageWithTop,scrolltolower:t.loadMore,scrolltoupper:t.refreshArticle}},[i("view",{staticStyle:{height:"160px",width:"100%"}}),t._l(t.showlist,function(t,e){return i("articlebrief",{key:t.id,attrs:{articleCard:t,mpcomid:"4d8a9a0a-1-"+e}})}),i("view",{staticClass:"marginHelper"})],2)],1)],1)},a=[];i.d(e,"a",function(){return o}),i.d(e,"b",function(){return a})},"100a":function(t,e,i){"use strict";i.r(e);var o=i("38b9"),a=i.n(o);for(var n in o)"default"!==n&&function(t){i.d(e,t,function(){return o[t]})}(n);e["default"]=a.a},"11ab":function(t,e,i){},"169f":function(t,e,i){"use strict";var o=i("665f"),a=i.n(o);a.a},"21e2":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n(i("4762")),a=n(i("1a96"));function n(t){return t&&t.__esModule?t:{default:t}}var s={props:{userInfo:{faceImg:"../static/touxiang.jpg"},topArticles:"",topHeight:""},components:{mainpageleft:o.default,searchpage:a.default},data:function(){return{showMainPageLeft:0,showSearch:0}},methods:{controlShowLeft:function(t){this.showMainPageLeft=t},controlShowSearch:function(t){console.log("this is controlShowSearch, receive data will be appied"),console.log(t),this.showSearch=t},jumpToSubmit:function(){t.navigateTo({url:"/pages/submit/submit"})},goToDetail:function(e){t.navigateTo({url:"/pages/detail/detail?data="+JSON.stringify(e)})}}};e.default=s}).call(this,i("6e42")["default"])},"2a19":function(t,e,i){"use strict";i.r(e);var o=i("21e2"),a=i.n(o);for(var n in o)"default"!==n&&function(t){i.d(e,t,function(){return o[t]})}(n);e["default"]=a.a},"2a73":function(t,e,i){"use strict";i.r(e);var o=i("54ac"),a=i("2a19");for(var n in a)"default"!==n&&function(t){i.d(e,t,function(){return a[t]})}(n);i("169f"),i("dcd4");var s=i("2877"),r=Object(s["a"])(a["default"],o["a"],o["b"],!1,null,"522c3bc0",null);e["default"]=r.exports},"38b9":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i("2f62");function a(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},o=Object.keys(i);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),o.forEach(function(e){n(t,e,i[e])})}return t}function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var s={props:{userInfo:{faceImg:"../static/touxiang.jpg",emailPrefix:"test123",emailSuffix:"@nottingham.edu.cn"}},data:function(){return{unreadMsgCount:t.getStorageSync("myMsgCount")}},computed:a({},(0,o.mapState)(["myMsgCount"])),watch:{myMsgCount:function(t,e){this.unreadMsgCount=t}},methods:{goToMessageListPage:function(){this.$store.commit("setMyMsgCount",0),t.navigateTo({url:"../messagelist/messagelist"})},goToProfile:function(){t.navigateTo({url:"../profile/profile"})},showToast:function(){t.showToast({title:"上课不要玩手机",duration:2e3,icon:"none"})},goToFansFollow:function(e){var i={currentTab:e,thisUserInfo:this.getGlobalUserInfo()};t.navigateTo({url:"../followlist/followlist?data="+JSON.stringify(i)})}}};e.default=s}).call(this,i("6e42")["default"])},"44f6":function(t,e,i){"use strict";var o=i("11ab"),a=i.n(o);a.a},4762:function(t,e,i){"use strict";i.r(e);var o=i("7bcf"),a=i("100a");for(var n in a)"default"!==n&&function(t){i.d(e,t,function(){return a[t]})}(n);i("73d1");var s=i("2877"),r=Object(s["a"])(a["default"],o["a"],o["b"],!1,null,"943bbc20",null);e["default"]=r.exports},5024:function(t,e,i){"use strict";i("5ad9");var o=n(i("b0ce")),a=n(i("e183"));function n(t){return t&&t.__esModule?t:{default:t}}Page((0,o.default)(a.default))},"54ac":function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{staticClass:"mainPageTopAll",staticStyle:{height:"100%"}},[t.showMainPageLeft?i("view",{staticClass:"bottomLayerOfLeft",attrs:{eventid:"f11d76d8-0"},on:{click:function(e){t.controlShowLeft(0)},touchmove:function(e){t.controlShowLeft(0)}}},[i("mainpageleft",{attrs:{userInfo:t.userInfo,mpcomid:"f11d76d8-0"}})],1):t._e(),t.showSearch?i("searchpage",{staticClass:"searchPage",attrs:{eventid:"f11d76d8-1",mpcomid:"f11d76d8-1"},on:{exitSearchSignal:t.controlShowSearch}}):t._e(),i("view",{staticClass:"mainPageTop",staticStyle:{"max-height":"160px"},style:{height:t.topHeight+"px;"}},[i("view",{staticClass:"topBar"},[i("image",{staticClass:"topBarTouxiang",attrs:{src:t.userInfo.faceImg,eventid:"f11d76d8-2"},on:{click:function(e){t.controlShowLeft(1)}}}),i("view",{staticClass:"topBarSearch",attrs:{eventid:"f11d76d8-3"},on:{click:function(e){t.controlShowSearch(1)}}},[t._v("⠀⠀搜索")]),i("view",{staticClass:"topBarPlus",attrs:{eventid:"f11d76d8-4"},on:{click:function(e){t.jumpToSubmit()}}},[i("view",{staticStyle:{"font-size":"20px",color:"#FDD041","border-radius":"3px"}},[t._v("+")])]),i("view",{staticClass:"topBarwaiting"})]),i("view",{staticClass:"topicTitle"},[t._v("话题榜")]),i("view",{staticClass:"topicArea"},[i("view",{staticClass:"hot1"},[i("view",{staticClass:"hotNum1",staticStyle:{"font-size":"21px","margin-bottom":"14px"}},[t._v("1")]),i("view",{staticClass:"hotContent1",staticStyle:{"font-size":"15px","margin-bottom":"14px"},attrs:{eventid:"f11d76d8-5"},on:{tap:function(e){t.goToDetail(t.topArticles[0])}}},[t._v(t._s(t.topArticles[0].articleTitle))])]),i("view",{staticClass:"hot2"},[i("view",{staticClass:"hotNum2",staticStyle:{"font-size":"17px","margin-bottom":"12px"}},[t._v("2")]),i("view",{staticClass:"hotContent2",staticStyle:{"font-size":"13px","margin-bottom":"12px"},attrs:{eventid:"f11d76d8-6"},on:{tap:function(e){t.goToDetail(t.topArticles[1])}}},[t._v(t._s(t.topArticles[1].articleTitle))])]),i("view",{staticClass:"hot3"},[i("view",{staticClass:"hotNum3",staticStyle:{"font-size":"15px"}},[t._v("3")]),i("view",{staticClass:"hotContent3",staticStyle:{"font-size":"13px"},attrs:{eventid:"f11d76d8-7"},on:{tap:function(e){t.goToDetail(t.topArticles[2])}}},[t._v(t._s(t.topArticles[2].articleTitle))])])])])],1)},a=[];i.d(e,"a",function(){return o}),i.d(e,"b",function(){return a})},"665f":function(t,e,i){},"73d1":function(t,e,i){"use strict";var o=i("9a11"),a=i.n(o);a.a},"7bcf":function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{staticClass:"mainPageLeft",attrs:{eventid:"66b384a8-8"},on:{click:function(t){t.stopPropagation()}}},[i("view",{staticClass:"topInfoArea"},[i("view",{staticClass:"topLeft"},[i("image",{staticClass:"touxiang",attrs:{src:t.userInfo.faceImg,eventid:"66b384a8-0"},on:{tap:t.goToProfile}})]),i("view",{staticClass:"topRight"},[i("view",{staticStyle:{"font-size":"13px","margin-bottom":"9px",width:"100%","vertical-align":"bottom",overflow:"hidden","text-overflow":"ellipsis","max-height":"20px","white-space":"nowrap"}},[t._v(t._s(t.userInfo.nickname))]),i("view",{staticStyle:{"font-size":"8px","font-weight":"bold","margin-bottom":"3px",width:"100%","vertical-align":"bottom"}},[t._v(t._s(t.userInfo.emailPrefix))]),i("view",{staticStyle:{color:"#B2B2B2","font-size":"6px",width:"100%",position:"relative",left:"10px","vertical-align":"bottom"}},[t._v(t._s(t.userInfo.emailSuffix))])])]),i("view",{staticClass:"personData"},[i("view",{staticClass:"hotNum"},[t._v("-")]),i("button",{staticClass:"yourFocus",attrs:{"hover-class":"customHover",eventid:"66b384a8-1"},on:{tap:function(e){t.goToFansFollow(0)}}},[t._v(t._s(t.userInfo.followNum))]),i("button",{staticClass:"focusYou",attrs:{"hover-class":"customHover",eventid:"66b384a8-2"},on:{tap:function(e){t.goToFansFollow(1)}}},[t._v(t._s(t.userInfo.fansNum))])],1),i("view",{staticClass:"personPageList"},[i("button",{staticClass:"pageLine",attrs:{eventid:"66b384a8-3"},on:{click:function(e){t.showToast()}}},[i("image",{attrs:{src:"../static/icon/write.png"}}),i("view",[t._v("我的发布")])]),i("button",{staticClass:"pageLine",attrs:{eventid:"66b384a8-4"},on:{tap:t.goToMessageListPage}},[i("image",{attrs:{src:"../static/icon/message.png"}}),i("view",[t._v("我的消息")]),t.unreadMsgCount>0&&t.unreadMsgCount<=99?i("view",{staticClass:"noticeNum"},[t._v(t._s(t.unreadMsgCount))]):t.unreadMsgCount>99?i("view",{staticClass:"noticeNum"},[t._v("99+")]):t._e()]),i("button",{staticClass:"pageLine",attrs:{eventid:"66b384a8-5"},on:{click:function(e){t.showToast()}}},[i("image",{attrs:{src:"../static/icon/star.png"}}),i("view",[t._v("我的收藏")])]),i("button",{staticClass:"pageLine",attrs:{eventid:"66b384a8-6"},on:{click:function(e){t.showToast()}}},[i("image",{attrs:{src:"../static/icon/report.png"}}),i("view",[t._v("举报投诉")])]),i("button",{staticClass:"pageLine",attrs:{eventid:"66b384a8-7"},on:{click:function(e){t.showToast()}}},[i("image",{attrs:{src:"../static/icon/about.png"}}),i("view",[t._v("关于")])])],1)])},a=[];i.d(e,"a",function(){return o}),i.d(e,"b",function(){return a})},"9a11":function(t,e,i){},b665:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=r(i("a34a")),a=r(i("64d6")),n=r(i("2a73")),s=r(i("4762"));i("2f62");function r(t){return t&&t.__esModule?t:{default:t}}function c(t,e,i,o,a,n,s){try{var r=t[n](s),c=r.value}catch(l){return void i(l)}r.done?e(c):Promise.resolve(c).then(o,a)}function l(t){return function(){var e=this,i=arguments;return new Promise(function(o,a){var n=t.apply(e,i);function s(t){c(n,o,a,s,r,"next",t)}function r(t){c(n,o,a,s,r,"throw",t)}s(void 0)})}}var u=!1,f=null,d={data:function(){return{title:"Hello",hottitlelist:["热门标题111","热门标题222","热门标题333"],showlist:[],topArticles:"",topHeight:160,userInfo:{id:"test-id123",nickname:"test-name",faceImg:"",faceImgThumb:"",email:"zy22089@nottingham.edu.cn",emailPrefix:"zy22089",emailSuffix:"@nottingham.edu.cn"},totalPage:1,currentPage:1,scrollTop:0,old:{scrollTop:0}}},components:{articlebrief:a.default,mainpagetop:n.default,mainpageleft:s.default},onLoad:function(){var e=this,i=this.getGlobalUserInfo();if(this.isNull(i))t.redirectTo({url:"../signin/signin"});else{this.userInfo=i,this.mySocket.init();var o=this.currentPage;this.showArticles(o),t.$on("flash",function(){e.refreshArticle()})}},onUnload:function(){t.$off("flash")},onShow:function(){var t=this.getGlobalUserInfo();this.isNull(t)||this.queryUserInfo(t.id),this.getTop3Articles()},methods:{showArticles:function(e){if(!u){u=!0,t.showLoading({title:"加载中..."});var i=this;t.request({url:i.$serverUrl+"/article/queryAllArticles",method:"POST",data:{page:e,userId:i.userInfo.id},header:{"content-type":"application/x-www-form-urlencoded"},success:function(o){setTimeout(function(){t.hideLoading(),u=!1,console.log(o),1==e&&(i.showlist=[]);var a=o.data.data.rows,n=i.showlist;i.showlist=n.concat(a),i.currentPage=e,i.totalPage=o.data.data.total},300)},fail:function(e){t.hideLoading(),u=!1,console.log("index unirequest fail"),console.log(e)}})}},loadMore:function(){var e=this,i=e.currentPage;console.log(i);var o=e.totalPage;if(console.log(o),i==o)t.showToast({title:"没有更多文章了",icon:"none",duration:1e3});else{var a=i+1;e.showArticles(a)}},refreshArticle:function(){t.showNavigationBarLoading(),this.showArticles(1),t.hideNavigationBarLoading()},getTop3Articles:function(){var e=this;t.request({url:e.$serverUrl+"/article/getHotTop3",method:"POST",data:{userId:e.userInfo.id},header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){e.topArticles=t.data.data}})},queryUserInfo:function(e){var i=this,o=this;t.request({url:o.$serverUrl+"/user/queryUser",method:"POST",data:{userId:e},header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){if(200==t.data.status){var e=t.data.data,o=i.myUser(e);i.setGlobalUserInfo(o),i.userInfo=o}}})},linkageWithTop:function(){var t=l(o.default.mark(function t(e){var i,a;return o.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:i=e.detail.scrollTop,console.log(i+"scrollTop"),console.log(f+"//  timer"),a=this,clearInterval(f),a.topHeight>160&&(a.topHeight=160),i>=100&&40!==a.topHeight?f=setInterval(function(){40==a.topHeight?clearInterval(f):(a.topHeight=a.topHeight-5,console.log(a.topHeight+"//  topHeight收起"))},1):(i<100&&160!==a.topHeight||0==i)&&(f=setInterval(function(){160==a.topHeight?clearInterval(f):(a.topHeight=a.topHeight+5,console.log(a.topHeight+"//  topHeight展开"))},1));case 7:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()}};e.default=d}).call(this,i("6e42")["default"])},dcd4:function(t,e,i){"use strict";var o=i("0bba"),a=i.n(o);a.a},e183:function(t,e,i){"use strict";i.r(e);var o=i("0de0"),a=i("0964");for(var n in a)"default"!==n&&function(t){i.d(e,t,function(){return a[t]})}(n);i("e8ad"),i("44f6");var s=i("2877"),r=Object(s["a"])(a["default"],o["a"],o["b"],!1,null,"0109b5c1",null);e["default"]=r.exports},e8ad:function(t,e,i){"use strict";var o=i("fc7a"),a=i.n(o);a.a},fc7a:function(t,e,i){}},[["5024","common/runtime","common/vendor"]]]);