<<<<<<< HEAD
<<<<<<< HEAD
{"version":3,"sources":["webpack:///C:/Users/WalkingDemon/Desktop/Git NQ/nuoquan/nuoquan-client/App.vue?9bc7","webpack:///C:/Users/WalkingDemon/Desktop/Git NQ/nuoquan/nuoquan-client/App.vue?21f5","webpack:///C:/Users/WalkingDemon/Desktop/Git NQ/nuoquan/nuoquan-client/App.vue","webpack:///C:/Users/WalkingDemon/Desktop/Git NQ/nuoquan/nuoquan-client/App.vue?1192","webpack:///C:/Users/WalkingDemon/Desktop/Git NQ/nuoquan/nuoquan-client/App.vue?424c"],"names":["onLaunch","console","log","onShow","onHide"],"mappings":";;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACuD;AACL;AACa;;;AAG/D;AACqK;AACrK,gBAAgB,gLAAU;AAC1B,EAAE,yEAAM;AACR;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,IAAI,KAAU,EAAE,YAYf;AACD;AACe,gF;;;;;;;;;;;AClCf;AAAA;AAAA;AAAA;AAAkwB,CAAgB,gxBAAG,EAAC,C;;;;;;;;;;;;ACCvwB;AACdA,UAAQ,EAAE,oBAAW;AACpBC,WAAO,CAACC,GAAR,CAAY,YAAZ;AACA,GAHa;AAIdC,QAAM,EAAE,kBAAW;AAClBF,WAAO,CAACC,GAAR,CAAY,UAAZ;AACA,GANa;AAOdE,QAAM,EAAE,kBAAW;AAClBH,WAAO,CAACC,GAAR,CAAY,UAAZ;AACA,GATa,E;;;;;;;;;;;ACDf;AAAA;AAAA;AAAA;AAA4jC,CAAgB,6iCAAG,EAAC,C;;;;;;;;;;ACAhlC,uC","file":"common/main.js","sourcesContent":["var render, staticRenderFns\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"C:\\\\Users\\\\WalkingDemon\\\\Downloads\\\\HBuilderX.1.9.9.20190522.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('07865814', component.options)\n    } else {\n      api.reload('07865814', component.options)\n    }\n    \n  }\n}\ncomponent.options.__file = \"Desktop/Git NQ/nuoquan/nuoquan-client/App.vue\"\nexport default component.exports","import mod from \"-!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./App.vue?vue&type=script&lang=js&\"","\nexport default {\n\tonLaunch: function() {\n\t\tconsole.log('App Launch')\n\t},\n\tonShow: function() {\n\t\tconsole.log('App Show')\n\t},\n\tonHide: function() {\n\t\tconsole.log('App Hide')\n\t},\n\n}\n","import mod from \"-!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-1!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--6-oneOf-1-2!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./App.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-1!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--6-oneOf-1-2!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../Downloads/HBuilderX.1.9.9.20190522.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./App.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin"],"sourceRoot":""}
=======
{"version":3,"sources":["webpack:///F:/codingWorkspace/nuoquan/nuoquan-client/main.js","webpack:///F:/codingWorkspace/nuoquan/nuoquan-client/App.vue?ddad","webpack:///F:/codingWorkspace/nuoquan/nuoquan-client/App.vue?f66e","webpack:///F:/codingWorkspace/nuoquan/nuoquan-client/App.vue","webpack:///F:/codingWorkspace/nuoquan/nuoquan-client/App.vue?710e","webpack:///F:/codingWorkspace/nuoquan/nuoquan-client/App.vue?5dbc"],"names":["app","Vue","store","App","$mount","mpType","config","productionTip","prototype","version","tagColors","$store","$serverUrl","$wsServerUrl","setGlobalUserInfo","user","uni","setStorageSync","getGlobalUserInfo","value","getStorageSync","removeGlobalUserInfo","removeStorageSync","setIntoList","obj","listName","listStr","list","isNull","JSON","parse","push","stringify","addIntoList","unshift","getListByKey","setUserInfoToUserList","userInfo","userListStr","userList","i","length","id","splice","getUserInfoFromUserList","userId","getCurrentPage","pages","getCurrentPages","currentPage","myUser","email","split","emailPrefix","emailSuffix","str","undefined","isBlank","RegExp","test","mySocket","isOpen","socketMsgQueue","init","that","connectSocket","url","complete","onSocketOpen","res","console","log","myUserId","dataContent","netty","DataContent","CONNECT","sendDataContent","action","CHAT","chat","fetchUnsignedChatMsg","notification","fetchUnsignedLikeMsg","fetchUnsignedCommentMsg","setInterval","keepAlive","onSocketError","onSocketMessage","data","LIKEARTICLE","LIKECOMMENT","COMMENTARTICLE","COMMENTCOMMENT","commit","chatMessage","signMsgList","msgId","myId","receiverId","friendId","senderId","msg","createDate","formatTime","saveUserChatHistory","FRIEND","page","route","pageFriendId","friendInfo","saveUserChatSnapshot","READ","newMessage","ChatHistory","UNREAD","signLikeArticleList","source","saveLikeMsg","signLikeCommentList","signCommentList","saveCommentMsg","onSocketClose","setTimeout","sendObj","toUserId","extand","timeStamp","Date","getTime","ChatMessage","isSocketOpen","sendSocketMessage","ME","msgIds","SIGNED","LIKEARTICLE_SIGN","LIKECOMMENT_SIGN","COMMENT_SIGN","KEEPALIVE","flag","ChatSnapshot","isRead","chatKey","chatHistoryListStr","chatHistoryList","singleMsg","getUserChatHistory","reverse","size","start","newList","deletUserChatHistory","chatSnapshotListStr","chatSnapshotList","getUserChatSnapShot","deletUserChatSnapShot","readUserChatSnapShot","item","request","method","header","success","status","unsignedMsgList","msgObj","acceptUserId","sendUserId","LIKEMSG_KEY","COMMENTMSG_KEY","getLikeMsg","getCommentMsg","likeArticleIds","likeCommentIds","commentIds","d","parseInt","year","getFullYear","month","getTwo","getMonth","date","getDate","hour","getHours","minute","getMinutes","second","getSeconds","s","timeDeal","timediff","parts","oldTime","now","newTime","milliseconds","timeSpanStr","Math","round","mixin","methods","setTabBarIndex","index","$mp","getTabBar","setData","selected","onLaunch","onShow","onHide"],"mappings":"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","file":"common/main.js","sourcesContent":["import 'uni-pages';import '@dcloudio/uni-stat';\r\nimport Vue from 'vue'\r\nimport App from './App'\r\nimport store from './store' // 引入 vuex 的 store 对象\r\n// import {mapMutations} from 'vuex';\r\n\r\nconst app = new Vue({\r\n\tstore,\r\n\t...App\r\n})\r\napp.$mount()\r\nApp.mpType = 'app'\r\n\r\nVue.config.productionTip = false\r\n\r\nVue.prototype.version = \"v1.0.3 - 公测版\"\r\nVue.prototype.tagColors = ['#FE5F55','#40A792','#FDD041','#5CA0D3','#621E81','#738598','#F3AE4B']\r\n\r\nVue.prototype.$store = store\r\n\r\n// Vue.prototype.$serverUrl = \"http://127.0.0.1:8080\"\r\n// Vue.prototype.$wsServerUrl = \"wss://127.0.0.1:8088/ws\"\r\n\r\n// 服务器地址\r\n// Vue.prototype.$serverUrl = \"http://129.28.130.27:8080/nottinghome\"\r\n// Vue.prototype.$wsServerUrl = \"ws://129.28.130.27:8088/ws\"\r\n\r\n// 安全服务器地址\r\nVue.prototype.$serverUrl = \"https://www.checkchack.cn:8443/nottinghome\"\r\nVue.prototype.$wsServerUrl = \"wss://www.checkchack.cn:8088/ws\"\r\n\r\n/**\r\n * 获取当前用户信息（我）\r\n * @param {Object} user\r\n */\r\nVue.prototype.setGlobalUserInfo = function(user) {\r\n\tuni.setStorageSync('userInfo', user);\r\n}\r\n\r\n/**\r\n * 设置当前用户信息\r\n */\r\nVue.prototype.getGlobalUserInfo = function() {\r\n\tvar value = uni.getStorageSync('userInfo');\r\n\treturn value;\r\n}\r\n\r\n/**\r\n * 清空当前用户信息\r\n */\r\nVue.prototype.removeGlobalUserInfo = function() {\r\n\tuni.removeStorageSync('userInfo');\r\n}\r\n\r\n/**\r\n * 把对象添加到列表尾部，并储存在缓存里\r\n * @param {Object} obj\r\n * @param {Object} list\r\n */\r\nVue.prototype.setIntoList = function(obj, listName) {\r\n\tvar listStr = uni.getStorageSync(listName)\r\n\t// 从本地缓存获取列表名是否存在\r\n\tvar list;\r\n\tif (app.isNull(listStr)) {\r\n\t\t// 为空，赋一个空的list；\r\n\t\tlist = [];\r\n\t} else {\r\n\t\t// 不为空\r\n\t\tlist = JSON.parse(listStr);\r\n\t}\r\n\t// 插入对象到尾部\r\n\tlist.push(obj);\r\n\tuni.setStorageSync(listName, JSON.stringify(list));\r\n}\r\n/**\r\n * 把对象添加到列表头部，并储存在缓存里\r\n * @param {Object} obj\r\n * @param {Object} listName\r\n */\r\nVue.prototype.addIntoList = function(obj, listName) {\r\n\tvar listStr = uni.getStorageSync(listName)\r\n\t// 从本地缓存获取列表名是否存在\r\n\tvar list;\r\n\tif (app.isNull(listStr)) {\r\n\t\t// 为空，赋一个空的list；\r\n\t\tlist = [];\r\n\t} else {\r\n\t\t// 不为空\r\n\t\tlist = JSON.parse(listStr);\r\n\t}\r\n\t// 插入对象到头部\r\n\tlist.unshift(obj);\r\n\tuni.setStorageSync(listName, JSON.stringify(list));\r\n}\r\n/**\r\n * 从缓存中按名字获取改名列表\r\n * @param {Object} listName\r\n */\r\nVue.prototype.getListByKey = function(listName){\r\n\tvar listStr = uni.getStorageSync(listName);\r\n\tvar list;\r\n\tif (app.isNull(listStr)) {\r\n\t\t// 为空，赋一个空的list；\r\n\t\tlist = [];\r\n\t} else {\r\n\t\t// 不为空\r\n\t\tlist = JSON.parse(listStr);\r\n\t}\r\n\t\r\n\treturn list;\r\n}\r\n\r\n\r\n/** TODO: 可使用 Map 代替 List 提升查询性能（暂时不知道 map 在 uniapp 中怎么写）\r\n *\t \t\t\t\t\t\t\t\t\t\t\t\t\t\t\tby Jerrio\r\n * 把该用户信息添加到本地缓存的 userlist 中，如果存在则替换\r\n * @param {Object} userInfo\r\n */\r\nVue.prototype.setUserInfoToUserList = function(userInfo) {\r\n\tvar userListStr = uni.getStorageSync(\"userList\");\r\n\tvar userList;\r\n\tif (app.isNull(userListStr)) {\r\n\t\t// 为空，赋一个空的list；\r\n\t\tuserList = [];\r\n\t} else {\r\n\t\t// 不为空，查看该用户是否存在\r\n\t\tvar userList = JSON.parse(userListStr);\r\n\t\tfor (var i = 0; i < userList.length; i++) {\r\n\t\t\tvar user = userList[i];\r\n\t\t\tif (user.id == userInfo.id) {\r\n\t\t\t\tuserList.splice(i, 1, userInfo); // 替换\r\n\t\t\t\tuni.setStorageSync(\"userList\", JSON.stringify(userList));\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t// 用户不存在\r\n\tuserList.push(userInfo);\r\n\tuni.setStorageSync(\"userList\", JSON.stringify(userList));\r\n}\r\n\r\n/**\r\n * 根据 userId，在本地缓存中获取该用户信息\r\n * @param {Object} userId\r\n */\r\nVue.prototype.getUserInfoFromUserList = function(userId) {\r\n\tvar userListStr = uni.getStorageSync(\"userList\");\r\n\r\n\tif (app.isNull(userListStr)) {\r\n\t\t// 为空，直接返回 null\r\n\t\treturn null;\r\n\t} else {\r\n\t\t// 不为空\r\n\t\tvar userList = JSON.parse(userListStr);\r\n\t\tfor (var i = 0; i < userList.length; i++) {\r\n\t\t\tvar user = userList[i];\r\n\t\t\tif (user.id == userId) {\r\n\t\t\t\treturn user;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n}\r\n\r\n/**\r\n * 返回页面栈最后一页(当前页面)\r\n */\r\nVue.prototype.getCurrentPage = function() {\r\n\tvar pages = getCurrentPages();\r\n\tvar currentPage = pages[pages.length - 1];\r\n\treturn currentPage;\r\n}\r\n/**\r\n * 从服务器查询用户信息, 并拼接额外信息。\r\n * [需要设置同步否则得不到值，还未测试，暂时弃用，请手动调用myUser拼接]\r\n */\r\n// Vue.prototype.myQueryUserInfo = async function(userId) {\r\n// \tvar that = this;\r\n// \tvar finalUser;\r\n// \tuni.request({\r\n// \t\turl: that.$serverUrl + '/user/queryUser',\r\n// \t\tmethod: \"POST\",\r\n// \t\tdata: {\r\n// \t\t\tuserId: userId\r\n// \t\t},\r\n// \t\theader: {\r\n// \t\t\t'content-type': 'application/x-www-form-urlencoded'\r\n// \t\t},\r\n// \t\tsuccess: (res) => {\r\n// \t\t\t// console.log(res)\r\n// \t\t\tif (res.data.status == 200) {\r\n// \t\t\t\t// 3.获取返回的用户信息\r\n// \t\t\t\tfinalUser = res.data.data;\r\n// \t\t\t\t// 4.分割邮箱地址, 重构user\r\n// \t\t\t\tfinalUser = that.myUser(finalUser);\r\n// \t\t\t}\r\n// \t\t\tconsole.log(\"里面\");\r\n// \t\t\tconsole.log(finalUser);\r\n// \t\t\treturn finalUser;\r\n// \t\t}\r\n// \t});\r\n// \t\r\n// \t// app.$nextTick(function(){\r\n// \t// \tconsole.log(finalUser);\r\n// \t// })\r\n// \t\r\n// \t// console.log(\"里面2\");\r\n// \t// console.log(finalUser);\r\n// \t// return finalUser;\r\n// }\r\n\r\n/**\r\n * 分割邮箱地址, 重构user\r\n * @param {Object} user\r\n */\r\nVue.prototype.myUser = function(user) {\r\n\t// 分割邮箱地址\r\n\tvar email = user.email;\r\n\tif (this.isNull(email)) {\r\n\t\temail = \"[Email]@nottingham.edu.cn\";\r\n\t}\r\n\tvar list = email.split('@');\r\n\tuser.emailPrefix = list[0];\r\n\tuser.emailSuffix = \"@\" + list[1];\r\n\r\n\treturn user\r\n}\r\n\r\nVue.prototype.isNull = function(str) {\r\n\tif (str == null || str == \"\" || str == undefined) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n/**\r\n * \"\" = true;\r\n * \" \" = true;\r\n */\r\nVue.prototype.isBlank = function(str) {\r\n\treturn RegExp(/^\\s*$/).test(str);\r\n}\r\n\r\n/**\r\n * 自定义封装 socket 供全局调用\r\n * @author: Jerrio\r\n */\r\nVue.prototype.mySocket = {\r\n\r\n\tisOpen: false,\r\n\tsocketMsgQueue: [], // 未发送的消息队列\t\r\n\r\n\tinit: function() {\r\n\t\tvar that = this;\r\n\t\t// 创建websocket长连接\r\n\t\tuni.connectSocket({\r\n\t\t\turl: app.$wsServerUrl,\r\n\t\t\tcomplete: () => {}\r\n\t\t});\r\n\r\n\t\tuni.onSocketOpen(function(res) {\r\n\t\t\tthat.isOpen = true;\r\n\t\t\tconsole.log('WebSocket连接已打开！isSocketOpen=' + that.isOpen);\r\n\t\t\t//发送连接消息，向服务器注册信息\r\n\t\t\tvar myUserId = app.getGlobalUserInfo().id; // 调用全局用户缓存，需要先请求获取\r\n\t\t\tif (app.isNull(myUserId)) {\r\n\t\t\t\tconsole.log(\"请先获取用户数据\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar dataContent = new app.netty.DataContent(app.netty.CONNECT, null, myUserId);\r\n\t\t\tthat.sendDataContent(dataContent);\r\n\t\t\t// 发送未发送的信息\r\n\t\t\tfor (var i = 0; i < that.socketMsgQueue.length; i++) {\r\n\t\t\t\tif (that.socketMsgQueue[i].action == app.netty.CHAT){\r\n\t\t\t\t\tthat.sendDataContent(that.socketMsgQueue[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthat.socketMsgQueue = [];\r\n\r\n\t\t\t// 签收未签收消息\r\n\t\t\tapp.chat.fetchUnsignedChatMsg(); // 获取聊天信息\r\n\t\t\tapp.notification.fetchUnsignedLikeMsg(); // 获取点赞通知\r\n\t\t\tapp.notification.fetchUnsignedCommentMsg(); // 获取评论通知\r\n\t\t\t// 定时发送心跳\r\n\t\t\tsetInterval(that.keepAlive, 50000);\r\n\t\t});\r\n\r\n\t\tuni.onSocketError(function(res) {\r\n\t\t\tconsole.log('WebSocket连接打开失败，请检查！');\r\n\t\t});\r\n\r\n\t\tuni.onSocketMessage(function(res) {\r\n\t\t\tvar dataContent = JSON.parse(res.data);\r\n\t\t\tconsole.log(\"收到服务器内容：\");\r\n\t\t\tconsole.log(dataContent);\r\n\t\t\tvar action = dataContent.action;\r\n\r\n\t\t\tif (action == app.netty.CHAT \r\n\t\t\t\t|| action == app.netty.LIKEARTICLE \r\n\t\t\t\t|| action == app.netty.LIKECOMMENT\r\n\t\t\t\t|| action == app.netty.COMMENTARTICLE\r\n\t\t\t\t|| action == app.netty.COMMENTCOMMENT) {\r\n\t\t\t\t\r\n\t\t\t\tapp.$store.commit('setMyMsgCount'); // 累加 msgCount in index.js\r\n\t\t\t\t\r\n\t\t\t\tswitch (action){\r\n\t\t\t\t\tcase app.netty.CHAT: // 如果消息类型为 CHAT\r\n\t\t\t\t\t\tvar chatMessage = dataContent.data;\r\n\t\t\t\t\t\t// 发送签收消息\r\n\t\t\t\t\t\tthat.signMsgList(chatMessage.msgId);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// 保存聊天历史记录到本地缓存\r\n\t\t\t\t\t\tvar myId = chatMessage.receiverId;\r\n\t\t\t\t\t\tvar friendId = chatMessage.senderId;\r\n\t\t\t\t\t\tvar msg = chatMessage.msg;\r\n\t\t\t\t\t\tvar createDate = app.formatTime(chatMessage.createDate); // 对时间戳进行格式化\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tapp.chat.saveUserChatHistory(myId, friendId, msg, app.chat.FRIEND, createDate);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// 判断当前页面，保存聊天快照\r\n\t\t\t\t\t\tvar page = app.getCurrentPage();\r\n\t\t\t\t\t\tif (page.route == 'pages/chatpage/chatpage') {\r\n\t\t\t\t\t\t\tvar pageFriendId = page.data.friendInfo.id; // 打开页面才有对象，越层判断会报对象为空的错\r\n\t\t\t\t\t\t\t/* \r\n\t\t\t\t\t\t\t【BUG】ISO 虚拟机获取 friendInfo.id 报错信息：\r\n\t\t\t\t\t\t\t undefined is not an object (evaluating 'page.data.friendInfo.id')\r\n\t\t\t\t\t\t\t 不知道真机会不会有这种情况\r\n\t\t\t\t\t\t\t*/\r\n\t\t\t\t\t\t\t// var pagestr = JSON.stringify(page.data);\r\n\t\t\t\t\t\t\t// console.log(pagestr);\r\n\t\t\t\t\t\t\tif (pageFriendId == friendId) {\r\n\t\t\t\t\t\t\t\t// 与该用户在聊天，标记为已读\r\n\t\t\t\t\t\t\t\tconsole.log(\"与该用户在聊天，标记为已读\");\r\n\t\t\t\t\t\t\t\tapp.chat.saveUserChatSnapshot(myId, friendId, msg, app.chat.READ, createDate);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// 修改 store，发送信号，把消息卡片渲染到对话窗口 和 消息列表\r\n\t\t\t\t\t\t\t\tvar newMessage = new app.chat.ChatHistory(myId, friendId, msg, app.chat.FRIEND, createDate);\r\n\t\t\t\t\t\t\t\tapp.$store.commit('setChatMessageCard', newMessage);\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t//不是与该用户聊天，标记为未读\r\n\t\t\t\t\t\t\t\tconsole.log(\"不是与该用户聊天，标记为未读\");\r\n\t\t\t\t\t\t\t\tapp.chat.saveUserChatSnapshot(myId, friendId, msg, app.chat.UNREAD, createDate);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// 聊天页面未打开，标记为未读\r\n\t\t\t\t\t\t\tconsole.log(\"聊天页面未打开，标记为未读\");\r\n\t\t\t\t\t\t\tapp.chat.saveUserChatSnapshot(myId, friendId, msg, app.chat.UNREAD, createDate);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase app.netty.LIKEARTICLE:\r\n\t\t\t\t\t\tconsole.log(\"获取点赞文章\");\r\n\t\t\t\t\t\t// 签收消息\r\n\t\t\t\t\t\tthat.signLikeArticleList(dataContent.data.source.id);\r\n\t\t\t\t\t\t// 存入缓存 (TODO：登陆时获取未签收点赞消息)\r\n\t\t\t\t\t\tdataContent.data.source.createDate = app.formatTime(dataContent.data.source.createDate);\r\n\t\t\t\t\t\tapp.notification.saveLikeMsg(dataContent);\r\n\t\t\t\t\t\tapp.$store.commit('setLikeMsgCount');\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase app.netty.LIKECOMMENT:\r\n\t\t\t\t\t\tconsole.log(\"获取点赞评论\");\r\n\t\t\t\t\t\t// 签收消息\r\n\t\t\t\t\t\tthat.signLikeCommentList(dataContent.data.source.id);\r\n\t\t\t\t\t\t// 存入缓存\r\n\t\t\t\t\t\tdataContent.data.source.createDate = app.formatTime(dataContent.data.source.createDate);\r\n\t\t\t\t\t\tapp.notification.saveLikeMsg(dataContent);\r\n\t\t\t\t\t\tapp.$store.commit('setLikeMsgCount');\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase app.netty.COMMENTARTICLE:\r\n\t\t\t\t\t\tconsole.log(\"获取评论文章\");\r\n\t\t\t\t\t\t// 签收消息\r\n\t\t\t\t\t\tthat.signCommentList(dataContent.data.source.id);\r\n\t\t\t\t\t\t// 存入缓存\r\n\t\t\t\t\t\tdataContent.data.source.createDate = app.formatTime(dataContent.data.source.createDate);\r\n\t\t\t\t\t\tapp.notification.saveCommentMsg(dataContent);\r\n\t\t\t\t\t\tapp.$store.commit('setCommentMsgCount');\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase app.netty.COMMENTCOMMENT:\r\n\t\t\t\t\t\tconsole.log(\"获取评论评论\");\r\n\t\t\t\t\t\t// 签收消息\r\n\t\t\t\t\t\tthat.signCommentList(dataContent.data.source.id);\r\n\t\t\t\t\t\t// 存入缓存\r\n\t\t\t\t\t\tdataContent.data.source.createDate = app.formatTime(dataContent.data.source.createDate);\r\n\t\t\t\t\t\tapp.notification.saveCommentMsg(dataContent);\r\n\t\t\t\t\t\tapp.$store.commit('setCommentMsgCount');\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tuni.onSocketClose(function(res) {\r\n\t\t\tthat.isOpen = false;\r\n\t\t\tconsole.log('WebSocket 已关闭！isSocketOpen=' + that.isOpen);\r\n\t\t\t// 三秒一次重连\r\n\t\t\tconsole.log(\"重连中..\");\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tthat.init();\r\n\t\t\t}, 3000);\r\n\t\t});\r\n\r\n\t},\r\n\t/**\r\n\t * 向 netty 服务器发送 聊天信息的方法 sendChatObj\r\n\t * @param {Object} type\r\n\t * @param {Object} toUserId\r\n\t * @param {Object} msg\r\n\t * @param {Object} extand\r\n\t */\r\n\tsendObj(action, toUserId, msg, extand) {\r\n\t\tvar myUserId = app.getGlobalUserInfo().id; // 调用全局用户缓存，需要先请求获取\r\n\t\tif (app.isNull(myUserId)) {\r\n\t\t\tconsole.log(\"请先获取用户数据\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// 获取当前时间戳，传输时间戳\r\n\t\tvar timeStamp = new Date().getTime();\r\n\r\n\t\t// 构建载体\r\n\t\tvar chatMessage = new app.netty.ChatMessage(myUserId, toUserId, msg, null, timeStamp);\r\n\t\tvar dataContent = new app.netty.DataContent(action, chatMessage, extand);\r\n\r\n\t\tvar isSocketOpen = app.mySocket.isOpen;\r\n\t\tif (isSocketOpen == true) {\r\n\t\t\tthis.sendDataContent(dataContent);\r\n\t\t} else {\r\n\t\t\t// 加到待发送列表\r\n\t\t\tconsole.log(\"isSocketOpen=\" + isSocketOpen);\r\n\t\t\tthis.socketMsgQueue.push(dataContent);\r\n\t\t\tconsole.log(this.socketMsgQueue);\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * 向 netty 服务器发送 DataConten 对象\r\n\t * @param {Object} dataContent\r\n\t */\r\n\tsendDataContent(dataContent) {\r\n\t\tvar data = JSON.stringify(dataContent);\r\n\t\tuni.sendSocketMessage({\r\n\t\t\tdata: data,\r\n\t\t});\r\n\t\t\r\n\t\tif (dataContent.action == app.netty.CHAT) {\r\n\t\t\t// 保存聊天历史到本地缓存，保存聊天快照到本地\r\n\t\t\tvar chatMessage = dataContent.data;\r\n\t\t\tvar createDate = app.formatTime(chatMessage.createDate);\r\n\t\t\t\r\n\t\t\t// console.log(\"发消息的时间戳：\" + createDate);\r\n\t\t\tapp.chat.saveUserChatHistory(chatMessage.senderId, \r\n\t\t\t\t\t\t\t\t\t\t chatMessage.receiverId, \r\n\t\t\t\t\t\t\t\t\t\t chatMessage.msg, \r\n\t\t\t\t\t\t\t\t\t\t app.chat.ME, \r\n\t\t\t\t\t\t\t\t\t\t createDate);\r\n\t\t\tapp.chat.saveUserChatSnapshot(chatMessage.senderId, \r\n\t\t\t\t\t\t\t\t\t\t  chatMessage.receiverId, \r\n\t\t\t\t\t\t\t\t\t\t  chatMessage.msg, \r\n\t\t\t\t\t\t\t\t\t\t  app.chat.READ, \r\n\t\t\t\t\t\t\t\t\t\t  createDate);\r\n\t\t\t// 刷到对话窗口\r\n\t\t\tapp.$store.commit('doFlashChatPage');\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * 批量签收聊天消息\r\n\t * @param {Object} msgIds\r\n\t */\r\n\tsignMsgList(msgIds) {\r\n\t\tvar dataContent = new app.netty.DataContent(app.netty.SIGNED, null, msgIds);\r\n\t\tthis.sendDataContent(dataContent);\r\n\t},\r\n\t\r\n\t/**\r\n\t * 批量签收点赞文章消息\r\n\t * @param {Object} msgIds\r\n\t */\r\n\tsignLikeArticleList(msgIds) {\r\n\t\tvar dataContent = new app.netty.DataContent(app.netty.LIKEARTICLE_SIGN, null, msgIds);\r\n\t\tthis.sendDataContent(dataContent);\r\n\t},\r\n\t\r\n\t/**\r\n\t * 批量签收点赞评论消息\r\n\t * @param {Object} msgIds\r\n\t */\r\n\tsignLikeCommentList(msgIds) {\r\n\t\tvar dataContent = new app.netty.DataContent(app.netty.LIKECOMMENT_SIGN, null, msgIds);\r\n\t\tthis.sendDataContent(dataContent);\r\n\t},\r\n\t\r\n\t/**\r\n\t * 批量签收评论消息\r\n\t * @param {Object} msgIds\r\n\t */\r\n\tsignCommentList(msgIds) {\r\n\t\tvar dataContent = new app.netty.DataContent(app.netty.COMMENT_SIGN, null, msgIds);\r\n\t\tthis.sendDataContent(dataContent);\r\n\t},\r\n\r\n\t/**\r\n\t * 发送心跳\r\n\t */\r\n\tkeepAlive() {\r\n\t\t// 用 setInterval 调用时，使用 this 获取不到实例，故用 app\r\n\t\tvar dataContent = new app.netty.DataContent(app.netty.KEEPALIVE, null, null);\r\n\t\tapp.mySocket.sendDataContent(dataContent);\r\n\t},\r\n}\r\n\r\nVue.prototype.chat = {\r\n\r\n\tME: 1, // 我的消息-右边\r\n\tFRIEND: 2, // 对方消息-左边\r\n\tREAD: 3,\r\n\tUNREAD: 4,\r\n\t/**\r\n\t * 历史记录对象\r\n\t * @param {Object} myId\r\n\t * @param {Object} friendId\r\n\t * @param {Object} msg\r\n\t * @param {Object} flag 是我的消息还是朋友的消息\r\n\t * @param {Object} createDate\r\n\t */\r\n\tChatHistory: function(myId, friendId, msg, flag, createDate) {\r\n\t\tthis.myId = myId;\r\n\t\tthis.friendId = friendId;\r\n\t\tthis.msg = msg;\r\n\t\tthis.flag = flag;\r\n\t\tthis.createDate = createDate;\r\n\t},\r\n\r\n\t/**\r\n\t * 快照对象\r\n\t * @param {Object} myId\r\n\t * @param {Object} friendId\r\n\t * @param {Object} msg\r\n\t * @param {Object} isRead 用于判断消息是已读还是未读\r\n\t * @param {Object} createDate\r\n\t */\r\n\tChatSnapshot: function(myId, friendId, msg, isRead, createDate) {\r\n\t\tthis.myId = myId;\r\n\t\tthis.friendId = friendId;\r\n\t\tthis.msg = msg;\r\n\t\tthis.isRead = isRead;\r\n\t\tthis.createDate = createDate;\r\n\t},\r\n\t/**\r\n\t * 保存用户的聊天记录\r\n\t * @param {Object} myId\r\n\t * @param {Object} friendId\r\n\t * @param {Object} msg\r\n\t * @param {Object} flag 判断本条消息是谁发送的, 1：我 2：朋友\r\n\t * @param {Object} createDate\r\n\t */\r\n\tsaveUserChatHistory: function(myId, friendId, msg, flag, createDate) {\r\n\r\n\t\tvar chatKey = \"chat-\" + myId + \"-\" + friendId;\r\n\t\t// 从本地缓存获取聊天记录是否存在\r\n\t\tvar chatHistoryListStr = uni.getStorageSync(chatKey);\r\n\t\tvar chatHistoryList;\r\n\t\tif (app.isNull(chatHistoryListStr)) {\r\n\t\t\t// 为空，赋一个空的list；\r\n\t\t\tchatHistoryList = [];\r\n\t\t} else {\r\n\t\t\t// 不为空\r\n\t\t\tchatHistoryList = JSON.parse(chatHistoryListStr);\r\n\t\t}\r\n\r\n\t\t// 构建聊天记录对象\r\n\t\tvar singleMsg = new this.ChatHistory(myId, friendId, msg, flag, createDate);\r\n\r\n\t\t// 添加到list尾部\r\n\t\tchatHistoryList.push(singleMsg);\r\n\r\n\t\tuni.setStorageSync(chatKey, JSON.stringify(chatHistoryList));\r\n\r\n\t},\r\n\t\r\n\t/**\r\n\t * 分页获取聊天历史，从列表尾部开始读取(反取)\r\n\t * @param {Object} myId\r\n\t * @param {Object} friendId\r\n\t * @param {Object} page\r\n\t */\r\n\tgetUserChatHistory: function(myId, friendId, page) {\r\n\t\tvar chatKey = \"chat-\" + myId + \"-\" + friendId;\r\n\t\tvar list = app.getListByKey(chatKey).reverse();\r\n\t\tvar size = 20;\r\n\t\tvar start = (page-1) * size;\r\n\t\tvar newList = [];\r\n\t\tif (list.length < start){\r\n\t\t\treturn null;\r\n\t\t}else{\r\n\t\t\tfor (var i=0; i<size; i++){\r\n\t\t\t\tif(!app.isNull(list[start+i])){\r\n\t\t\t\t\tnewList.unshift(list[start+i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn newList;\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * 删除我和朋友的聊天记录\r\n\t * @param {Object} myId\r\n\t * @param {Object} friendId\r\n\t */\r\n\tdeletUserChatHistory: function(myId, friendId) {\r\n\t\tvar chatKey = \"chat-\" + myId + \"-\" + friendId;\r\n\t\tuni.removeStorageSync(chatKey);\r\n\t},\r\n\r\n\t/**\r\n\t * 聊天记录快照，仅保存每次和朋友聊天的最后一条消息\r\n\t * @param {Object} myId\r\n\t * @param {Object} friendId\r\n\t * @param {Object} msg\r\n\t * @param {Object} isRead\r\n\t * @param {Object} createDate\r\n\t */\r\n\tsaveUserChatSnapshot: function(myId, friendId, msg, isRead, createDate) {\r\n\r\n\t\tvar chatKey = \"chat-snapshot\" + myId;\r\n\r\n\t\t// 从本地缓存获取聊天快照的 list\r\n\t\tvar chatSnapshotListStr = uni.getStorageSync(chatKey);\r\n\t\tvar chatSnapshotList;\r\n\t\tif (app.isNull(chatSnapshotListStr)) {\r\n\t\t\t// 为空，赋一个空的list；\r\n\t\t\tchatSnapshotList = [];\r\n\t\t} else {\r\n\t\t\t// 不为空\r\n\t\t\tchatSnapshotList = JSON.parse(chatSnapshotListStr);\r\n\t\t\t// 循环快照list，删除含 friendId 的项\r\n\t\t\tfor (var i = 0; i < chatSnapshotList.length; i++) {\r\n\t\t\t\tif (chatSnapshotList[i].friendId == friendId) {\r\n\t\t\t\t\tchatSnapshotList.splice(i, 1); // 从i项往后删，只删一个\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t// 构建聊天快照对象\r\n\t\tvar singleMsg = new this.ChatSnapshot(myId, friendId, msg, isRead, createDate);\r\n\t\t// 添加到 list 第一项\r\n\t\tchatSnapshotList.unshift(singleMsg);\r\n\r\n\t\tuni.setStorageSync(chatKey, JSON.stringify(chatSnapshotList));\r\n\t},\r\n\r\n\t/**\r\n\t * 获取用户快照记录列表\r\n\t */\r\n\tgetUserChatSnapShot: function(myId) {\r\n\t\tvar chatKey = \"chat-snapshot\" + myId;\r\n\r\n\t\t// 从本地缓存获取聊天快照的 list\r\n\t\tvar chatSnapshotListStr = uni.getStorageSync(chatKey);\r\n\t\tvar chatSnapshotList;\r\n\t\tif (app.isNull(chatSnapshotListStr)) {\r\n\t\t\t// 为空，赋一个空的list；\r\n\t\t\tchatSnapshotList = [];\r\n\t\t} else {\r\n\t\t\t// 不为空\r\n\t\t\tchatSnapshotList = JSON.parse(chatSnapshotListStr);\r\n\t\t}\r\n\r\n\t\treturn chatSnapshotList;\r\n\t},\r\n\r\n\t/**\r\n\t * 删除与该用户的聊天快照记录\r\n\t * @param {Object} myId\r\n\t * @param {Object} friendId\r\n\t */\r\n\tdeletUserChatSnapShot: function(myId, friendId) {\r\n\t\tvar chatKey = \"chat-snapshot\" + myId;\r\n\t\t// 从本地缓存获取聊天快照的 list\r\n\t\tvar chatSnapshotListStr = uni.getStorageSync(chatKey);\r\n\t\tvar chatSnapshotList;\r\n\t\tif (app.isNull(chatSnapshotListStr)) {\r\n\t\t\t// 为空，不作处理\r\n\t\t\treturn;\r\n\t\t} else {\r\n\t\t\t// 不为空\r\n\t\t\tchatSnapshotList = JSON.parse(chatSnapshotListStr);\r\n\t\t\t// 循环快照list，删除含 friendId 的项\r\n\t\t\tfor (var i = 0; i < chatSnapshotList.length; i++) {\r\n\t\t\t\tif (chatSnapshotList[i].friendId == friendId) {\r\n\t\t\t\t\tchatSnapshotList.splice(i, 1); // 从i项往后删，只删一个\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tuni.setStorageSync(chatKey, JSON.stringify(chatSnapshotList));\r\n\t},\r\n\r\n\t/**\r\n\t * 把快照标记为已读，并且不改变在列表中的位置\r\n\t * @param {Object} myId\r\n\t * @param {Object} friendId\r\n\t */\r\n\treadUserChatSnapShot: function(myId, friendId) {\r\n\t\tvar chatKey = \"chat-snapshot\" + myId;\r\n\r\n\t\t// 从本地缓存获取聊天快照的 list\r\n\t\tvar chatSnapshotListStr = uni.getStorageSync(chatKey);\r\n\t\tvar chatSnapshotList;\r\n\t\tif (app.isNull(chatSnapshotListStr)) {\r\n\t\t\t// 为空，赋一个空的list；\r\n\t\t\treturn;\r\n\t\t} else {\r\n\t\t\t// 不为空\r\n\t\t\tchatSnapshotList = JSON.parse(chatSnapshotListStr);\r\n\t\t\t// 删除快照对象并放入新的在原有位置\r\n\t\t\tfor (var i = 0; i < chatSnapshotList.length; i++) {\r\n\t\t\t\tvar item = chatSnapshotList[i];\r\n\t\t\t\tif (item.friendId == friendId) {\r\n\t\t\t\t\titem.isRead = this.READ;\r\n\t\t\t\t\tchatSnapshotList.splice(i, 1, item); // 替换\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tuni.setStorageSync(chatKey, JSON.stringify(chatSnapshotList));\r\n\t\t}\r\n\t},\r\n\r\n\tfetchUnsignedChatMsg: function() {\r\n\t\tvar user = app.getGlobalUserInfo();\r\n\t\tvar msgIds = \",\" // 格式: ,1001,1002,1003,\r\n\t\tvar that = this;\r\n\t\tuni.request({\r\n\t\t\turl: app.$serverUrl + '/user/getUnsignedMsg',\r\n\t\t\tmethod: \"POST\",\r\n\t\t\tdata: {\r\n\t\t\t\tuserId: user.id\r\n\t\t\t},\r\n\t\t\theader: {\r\n\t\t\t\t'content-type': 'application/x-www-form-urlencoded'\r\n\t\t\t},\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\t// console.log(res)\r\n\t\t\t\tif (res.data.status == 200) {\r\n\t\t\t\t\tvar unsignedMsgList = res.data.data;\r\n\t\t\t\t\tconsole.log(unsignedMsgList);\r\n\t\t\t\t\tif (!app.isNull(unsignedMsgList)) {\r\n\t\t\t\t\t\tapp.$store.commit('setMyMsgCount', unsignedMsgList.length); // 增加 msgCount in index.js\r\n\t\t\t\t\t\tfor (var i = 0; i < unsignedMsgList.length; i++) {\r\n\t\t\t\t\t\t\tvar msgObj = unsignedMsgList[i];\r\n\t\t\t\t\t\t\tvar timeStamp = new Date(msgObj.createDate).getTime();\r\n\t\t\t\t\t\t\tvar createDate = app.formatTime(timeStamp);\r\n\t\t\t\t\t\t\t// 1.逐条存入聊天记录\r\n\t\t\t\t\t\t\tthis.saveUserChatHistory(msgObj.acceptUserId,\r\n\t\t\t\t\t\t\t\tmsgObj.sendUserId,\r\n\t\t\t\t\t\t\t\tmsgObj.msg,\r\n\t\t\t\t\t\t\t\tthis.FRIEND,\r\n\t\t\t\t\t\t\t\tcreateDate);\r\n\t\t\t\t\t\t\t// 2.保存聊天快照到本地\r\n\t\t\t\t\t\t\tthis.saveUserChatSnapshot(msgObj.acceptUserId,\r\n\t\t\t\t\t\t\t\tmsgObj.sendUserId,\r\n\t\t\t\t\t\t\t\tmsgObj.msg,\r\n\t\t\t\t\t\t\t\tthis.UNREAD,\r\n\t\t\t\t\t\t\t\tcreateDate);\r\n\t\t\t\t\t\t\t// 3.拼接批量签收id的字符串\r\n\t\t\t\t\t\t\tmsgIds += msgObj.id + \",\";\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// 调用批量签收方法\r\n\t\t\t\t\t\tapp.mySocket.signMsgList(msgIds);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\n/**\r\n * 点赞评论通知\r\n */\r\nVue.prototype.notification={\t\r\n\tLIKEMSG_KEY : \"likeMsg\" + app.getGlobalUserInfo().id,\r\n\tCOMMENTMSG_KEY : \"commentMsg\" + app.getGlobalUserInfo().id,\r\n\t/**\r\n\t * 把点赞通知存入缓存\r\n\t * @param {Object} dataContent\r\n\t */\r\n\tsaveLikeMsg(dataContent){\r\n\t\tapp.addIntoList(dataContent, this.LIKEMSG_KEY);\r\n\t},\r\n\t\r\n\tgetLikeMsg(page){\r\n\t\tvar size = 10;\r\n\t\tvar list = app.getListByKey(this.LIKEMSG_KEY);\r\n\t\tvar start = (page-1) * size;\r\n\t\tvar newList = [];\r\n\t\tif (list.length < start){\r\n\t\t\treturn null;\r\n\t\t}else{\r\n\t\t\tfor (var i=0; i<size; i++){\r\n\t\t\t\tif(!app.isNull(list[start+i])){\r\n\t\t\t\t\tnewList.push(list[start+i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn newList;\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * 把评论通知存入缓存\r\n\t * @param {Object} dataContent\r\n\t */\r\n\tsaveCommentMsg(dataContent){\r\n\t\tapp.addIntoList(dataContent, this.COMMENTMSG_KEY);\r\n\t},\r\n\t\r\n\tgetCommentMsg(page){\r\n\t\tvar size = 10;\r\n\t\tvar list = app.getListByKey(this.COMMENTMSG_KEY);\r\n\t\tvar start = (page-1) * size;\r\n\t\tvar newList = [];\r\n\t\tif (list.length < start){\r\n\t\t\treturn null;\r\n\t\t}else{\r\n\t\t\tfor (var i=0; i<size; i++){\r\n\t\t\t\tif(!app.isNull(list[start+i])){\r\n\t\t\t\t\tnewList.push(list[start+i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn newList;\r\n\t\t}\r\n\t},\r\n\t\r\n\t/**\r\n\t * 获取并签收未签收的点赞通知\r\n\t */\r\n\tfetchUnsignedLikeMsg(){\r\n\t\tvar user = app.getGlobalUserInfo();\r\n\t\tvar likeArticleIds = \",\" // 格式: ,1001,1002,1003,\r\n\t\tvar likeCommentIds = \",\"\r\n\t\tvar that = this;\r\n\t\tuni.request({\r\n\t\t\turl: app.$serverUrl + '/article/getUnsignedLikeMsg',\r\n\t\t\tmethod: \"POST\",\r\n\t\t\tdata: {\r\n\t\t\t\tuserId: user.id\r\n\t\t\t},\r\n\t\t\theader: {\r\n\t\t\t\t'content-type': 'application/x-www-form-urlencoded'\r\n\t\t\t},\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\t// console.log(res)\r\n\t\t\t\tif (res.data.status == 200) {\r\n\t\t\t\t\tvar unsignedMsgList = res.data.data;\r\n\t\t\t\t\tconsole.log(unsignedMsgList);\r\n\t\t\t\t\tif (!app.isNull(unsignedMsgList)) {\r\n\t\t\t\t\t\tfor (var i = 0; i < unsignedMsgList.length; i++) {\r\n\t\t\t\t\t\t\tvar dataContent = unsignedMsgList[i];\r\n\t\t\t\t\t\t\t//累加信息\r\n\t\t\t\t\t\t\tapp.$store.commit('setMyMsgCount'); // 累加通用信息\r\n\t\t\t\t\t\t\tapp.$store.commit('setLikeMsgCount'); //累加点赞信息\r\n\t\t\t\t\t\t\t// 逐条存入缓存\r\n\t\t\t\t\t\t\tdataContent.data.source.createDate = app.formatTime(dataContent.data.source.createDate);\r\n\t\t\t\t\t\t\tapp.notification.saveLikeMsg(dataContent);\r\n\t\t\t\t\t\t\t// 拼接批量签收id的字符串\r\n\t\t\t\t\t\t\tswitch (dataContent.action){\r\n\t\t\t\t\t\t\t\tcase app.netty.LIKEARTICLE:\r\n\t\t\t\t\t\t\t\t\tlikeArticleIds += dataContent.data.source.id + \",\";\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase app.netty.LIKECOMMENT:\r\n\t\t\t\t\t\t\t\t\tlikeCommentIds += dataContent.data.source.id + \",\";\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\r\n\t\t\t\t\t\t// 调用批量签收方法\r\n\t\t\t\t\t\tapp.mySocket.signLikeArticleList(likeArticleIds);\r\n\t\t\t\t\t\tapp.mySocket.signLikeCommentList(likeCommentIds);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\t\r\n\t/**\r\n\t * 获取并签收未签收的评论通知\r\n\t */\r\n\tfetchUnsignedCommentMsg(){\r\n\t\tvar user = app.getGlobalUserInfo();\r\n\t\tvar commentIds = \",\" // 格式: ,1001,1002,1003,\r\n\t\tvar that = this;\r\n\t\tuni.request({\r\n\t\t\turl: app.$serverUrl + '/article/getUnsignedCommentMsg',\r\n\t\t\tmethod: \"POST\",\r\n\t\t\tdata: {\r\n\t\t\t\tuserId: user.id\r\n\t\t\t},\r\n\t\t\theader: {\r\n\t\t\t\t'content-type': 'application/x-www-form-urlencoded'\r\n\t\t\t},\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\t// console.log(res)\r\n\t\t\t\tif (res.data.status == 200) {\r\n\t\t\t\t\tvar unsignedMsgList = res.data.data;\r\n\t\t\t\t\tconsole.log(unsignedMsgList);\r\n\t\t\t\t\tif (!app.isNull(unsignedMsgList)) {\r\n\t\t\t\t\t\tfor (var i = 0; i < unsignedMsgList.length; i++) {\r\n\t\t\t\t\t\t\tvar dataContent = unsignedMsgList[i];\r\n\t\t\t\t\t\t\t//累加信息\r\n\t\t\t\t\t\t\tapp.$store.commit('setMyMsgCount'); // 累加通用信息\r\n\t\t\t\t\t\t\tapp.$store.commit('setCommentMsgCount'); //累加评论信息\r\n\t\t\t\t\t\t\t// 逐条存入缓存\r\n\t\t\t\t\t\t\tdataContent.data.source.createDate = app.formatTime(dataContent.data.source.createDate);\r\n\t\t\t\t\t\t\tapp.notification.saveCommentMsg(dataContent);\r\n\t\t\t\t\t\t\t// 拼接批量签收id的字符串\r\n\t\t\t\t\t\t\tcommentIds += dataContent.data.source.id + \",\";\r\n\t\t\t\t\t\t}\r\n\t\t\r\n\t\t\t\t\t\t// 调用批量签收方法\r\n\t\t\t\t\t\tapp.mySocket.signCommentList(commentIds);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\nVue.prototype.netty = {\r\n\t/**\r\n\t * 和后端的枚举对应\r\n\t */\r\n\tCONNECT: 1, \t\t\t// 第一次(或重连)初始化连接\r\n\tCHAT: 2,\t\t\t\t// 聊天消息\r\n\tSIGNED: 3, \t\t\t\t// 消息签收\r\n\tKEEPALIVE: 4, \t\t\t// 客户端保持心跳\r\n\tLIKEARTICLE: 5, \t\t// 点赞文章通知\r\n\tLIKECOMMENT: 6, \t\t// 点赞评论通知\r\n\tCOMMENTARTICLE: 7, \t\t// 评论文章通知\r\n\tCOMMENTCOMMENT: 8,\t\t// 评论评论通知\r\n\tLIKEARTICLE_SIGN: 9, \t// 签收点赞文章通知\r\n\tLIKECOMMENT_SIGN: 10, \t// 签收点赞评论通知\r\n\tCOMMENT_SIGN: 11, \t\t// 签收评论文章通知\r\n\r\n\t/**\r\n\t * 和后端 ChatMessage 聊天模型的对象保持一致\r\n\t * @param {Object} senderId\r\n\t * @param {Object} receiverId\r\n\t * @param {Object} msg\r\n\t * @param {Object} msgId\r\n\t * @param {Object} createDate\r\n\t */\r\n\tChatMessage: function(senderId, receiverId, msg, msgId, createDate) {\r\n\t\tthis.senderId = senderId;\r\n\t\tthis.receiverId = receiverId;\r\n\t\tthis.msg = msg;\r\n\t\tthis.msgId = msgId; // 前端发送设置null就好\r\n\t\tthis.createDate = createDate;\r\n\t},\r\n\t\r\n\t/**\r\n\t * 构建消息 DataContent 模型对象\r\n\t * @param {Object} action\r\n\t * @param {Object} data\r\n\t * @param {Object} extand\r\n\t */\r\n\tDataContent: function(action, data, extand) {\r\n\t\tthis.action = action;\r\n\t\tthis.data = data;\r\n\t\tthis.extand = extand;\r\n\t},\r\n}\r\n\r\n/**\r\n * 格式化时间戳\r\n * @param {Object} timeStamp\r\n */\r\nVue.prototype.formatTime = function(timeStamp) {\r\n\t// 将/[0-9]/位的数字编成/0[0-9]/  \r\n\r\n\tif (timeStamp.length < 13) {\r\n\t\ttimeStamp += \"000\";\r\n\t}\r\n\tvar d = new Date(parseInt(timeStamp));\r\n\r\n\tvar year = d.getFullYear();\r\n\tvar month = this.getTwo(d.getMonth() + 1);\r\n\tvar date = this.getTwo(d.getDate());\r\n\tvar hour = this.getTwo(d.getHours());\r\n\tvar minute = this.getTwo(d.getMinutes());\r\n\tvar second = this.getTwo(d.getSeconds());\r\n\t\r\n\treturn month + \"/\" + date + \" \" + hour + \":\" + minute;\r\n\t// 明年改加上年的逻辑 鸣谦说的...\r\n\t// return year + \"/\" + month + \"/\" + date + \" \" + hour + \":\" + minute + \":\" + second;\r\n}\r\n\r\nVue.prototype.getTwo = function(s) {\r\n\tif (parseInt(s) < 10) {\r\n\t\treturn \"0\" + s;\r\n\t} else {\r\n\t\treturn \"\" + s;\r\n\t}\r\n}\r\n\r\n/**\r\n * Timestamp 渲染\r\n * @param {Object} timediff\r\n */\r\nVue.prototype.timeDeal = function(timediff) {\r\n\tconsole.log(timediff);\r\n\ttimediff = new Date(timediff);\r\n\tconsole.log(timediff);\r\n\tvar parts = [timediff.getFullYear(), timediff.getMonth(), timediff.getDate(), timediff.getHours(), timediff.getMinutes(),\r\n\t\ttimediff.getSeconds()\r\n\t];\r\n\tvar oldTime = timediff.getTime();\r\n\tvar now = new Date();\r\n\tvar newTime = now.getTime();\r\n\tvar milliseconds = 0;\r\n\tvar timeSpanStr;\r\n\tmilliseconds = newTime - oldTime;\r\n\tif (milliseconds <= 1000 * 60 * 1) {\r\n\t\ttimeSpanStr = '刚刚';\r\n\t} else if (1000 * 60 * 1 < milliseconds && milliseconds <= 1000 * 60 * 60) {\r\n\t\ttimeSpanStr = Math.round((milliseconds / (1000 * 60))) + '分钟前';\r\n\t} else if (1000 * 60 * 60 * 1 < milliseconds && milliseconds <= 1000 * 60 * 60 * 24) {\r\n\t\ttimeSpanStr = Math.round(milliseconds / (1000 * 60 * 60)) + '小时前';\r\n\t} else if (1000 * 60 * 60 * 24 < milliseconds && milliseconds <= 1000 * 60 * 60 * 24 * 15) {\r\n\t\ttimeSpanStr = Math.round(milliseconds / (1000 * 60 * 60 * 24)) + '天前';\r\n\t\t\r\n\t} else if (milliseconds > 1000 * 60 * 60 * 24 * 15 && parts[0] == now.getFullYear()) {\r\n\t\ttimeSpanStr = parts[1] + '-' + parts[2] + ' ' + parts[3] + ':' + parts[4];\r\n\t} else {\r\n\t\ttimeSpanStr = parts[0] + '-' + parts[1] + '-' + parts[2] + ' ' + parts[3] + ':' + parts[4];\r\n\t}\r\n\treturn timeSpanStr;\r\n}\r\n\r\n// 封装tabbar索引，避免重复书写\r\nVue.mixin({\r\n  methods:{\r\n    setTabBarIndex(index){\r\n      if (typeof this.$mp.page.getTabBar === 'function' &&\r\n        this.$mp.page.getTabBar()) {\r\n        this.$mp.page.getTabBar().setData({\r\n          selected:index\r\n        })\r\n      }\r\n    }\r\n  }\r\n})","var render, staticRenderFns\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('727a21f0', component.options)\n    } else {\n      api.reload('727a21f0', component.options)\n    }\n    \n  }\n}\ncomponent.options.__file = \"F:/codingWorkspace/nuoquan/nuoquan-client/App.vue\"\nexport default component.exports","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-custom-block-loader\\\\index.js??ref--0-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-custom-block-loader\\\\index.js??ref--0-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./App.vue?vue&type=script&lang=js&\"","\nexport default {\n\tonLaunch: function() {\n\t\tconsole.log('App Launch')\n\t},\n\tonShow: function() {\n\t\tconsole.log('App Show')\n\t},\n\tonHide: function() {\n\t\tconsole.log('App Hide')\n\t},\n\n}\n","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-custom-block-loader\\\\index.js??ref--0-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./App.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-custom-block-loader\\\\index.js??ref--0-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./App.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin"],"sourceRoot":""}
>>>>>>> guetta-new
=======
{"version":3,"sources":["webpack:////Users/jerrio/Desktop/JumboX/诺圈/Nuoquan/nuoquan-client/main.js","webpack:////Users/jerrio/Desktop/JumboX/诺圈/Nuoquan/nuoquan-client/App.vue?0063","webpack:////Users/jerrio/Desktop/JumboX/诺圈/Nuoquan/nuoquan-client/App.vue?1b82","webpack:////Users/jerrio/Desktop/JumboX/诺圈/Nuoquan/nuoquan-client/App.vue","webpack:////Users/jerrio/Desktop/JumboX/诺圈/Nuoquan/nuoquan-client/App.vue?f754","webpack:////Users/jerrio/Desktop/JumboX/诺圈/Nuoquan/nuoquan-client/App.vue?97cf"],"names":["app","Vue","store","App","$mount","mpType","config","productionTip","prototype","version","tagColors","$store","$serverUrl","$wsServerUrl","setGlobalUserInfo","user","uni","setStorageSync","getGlobalUserInfo","value","getStorageSync","removeGlobalUserInfo","removeStorageSync","setIntoList","obj","listName","listStr","list","isNull","JSON","parse","push","stringify","addIntoList","unshift","getListByKey","setUserInfoToUserList","userInfo","userListStr","userList","i","length","id","splice","getUserInfoFromUserList","userId","getCurrentPage","pages","getCurrentPages","currentPage","myUser","email","split","emailPrefix","emailSuffix","str","undefined","isBlank","RegExp","test","mySocket","isOpen","socketMsgQueue","init","that","connectSocket","url","complete","onSocketOpen","res","console","log","myUserId","dataContent","netty","DataContent","CONNECT","sendDataContent","action","CHAT","chat","fetchUnsignedChatMsg","notification","fetchUnsignedLikeMsg","fetchUnsignedCommentMsg","setInterval","keepAlive","onSocketError","onSocketMessage","data","LIKEARTICLE","LIKECOMMENT","COMMENTARTICLE","COMMENTCOMMENT","commit","chatMessage","signMsgList","msgId","myId","receiverId","friendId","senderId","msg","createDate","formatTime","saveUserChatHistory","FRIEND","page","route","pageFriendId","friendInfo","saveUserChatSnapshot","READ","newMessage","ChatHistory","UNREAD","signLikeArticleList","source","saveLikeMsg","signLikeCommentList","signCommentList","saveCommentMsg","onSocketClose","setTimeout","sendObj","toUserId","extand","timeStamp","Date","getTime","ChatMessage","isSocketOpen","sendSocketMessage","ME","msgIds","SIGNED","LIKEARTICLE_SIGN","LIKECOMMENT_SIGN","COMMENT_SIGN","KEEPALIVE","flag","ChatSnapshot","isRead","chatKey","chatHistoryListStr","chatHistoryList","singleMsg","getUserChatHistory","reverse","size","start","newList","deletUserChatHistory","chatSnapshotListStr","chatSnapshotList","getUserChatSnapShot","deletUserChatSnapShot","readUserChatSnapShot","item","request","method","header","success","status","unsignedMsgList","msgObj","acceptUserId","sendUserId","LIKEMSG_KEY","COMMENTMSG_KEY","getLikeMsg","getCommentMsg","likeArticleIds","likeCommentIds","commentIds","d","parseInt","year","getFullYear","month","getTwo","getMonth","date","getDate","hour","getHours","minute","getMinutes","second","getSeconds","s","timeDeal","timediff","parts","oldTime","now","newTime","milliseconds","timeSpanStr","Math","round","mixin","methods","setTabBarIndex","index","$mp","getTabBar","setData","selected","onLaunch","onShow","onHide"],"mappings":"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","file":"common/main.js","sourcesContent":["import 'uni-pages';import '@dcloudio/uni-stat';\nimport Vue from 'vue'\nimport App from './App'\nimport store from './store' // 引入 vuex 的 store 对象\n// import {mapMutations} from 'vuex';\n\nconst app = new Vue({\n\tstore,\n\t...App\n})\napp.$mount()\nApp.mpType = 'app'\n\nVue.config.productionTip = false\n\nVue.prototype.version = \"v1.0.3 - 公测版\"\nVue.prototype.tagColors = ['#FE5F55','#40A792','#FDD041','#5CA0D3','#621E81','#738598','#F3AE4B']\n\nVue.prototype.$store = store\n\n// Vue.prototype.$serverUrl = \"http://127.0.0.1:8080\"\n// Vue.prototype.$wsServerUrl = \"wss://127.0.0.1:8088/ws\"\n\n// 服务器地址\n// Vue.prototype.$serverUrl = \"http://129.28.130.27:8080/nottinghome\"\n// Vue.prototype.$wsServerUrl = \"ws://129.28.130.27:8088/ws\"\n\n// 安全服务器地址\nVue.prototype.$serverUrl = \"https://www.checkchack.cn:8443/nottinghome\"\nVue.prototype.$wsServerUrl = \"wss://www.checkchack.cn:8088/ws\"\n\n/**\n * 获取当前用户信息（我）\n * @param {Object} user\n */\nVue.prototype.setGlobalUserInfo = function(user) {\n\tuni.setStorageSync('userInfo', user);\n}\n\n/**\n * 设置当前用户信息\n */\nVue.prototype.getGlobalUserInfo = function() {\n\tvar value = uni.getStorageSync('userInfo');\n\treturn value;\n}\n\n/**\n * 清空当前用户信息\n */\nVue.prototype.removeGlobalUserInfo = function() {\n\tuni.removeStorageSync('userInfo');\n}\n\n/**\n * 把对象添加到列表尾部，并储存在缓存里\n * @param {Object} obj\n * @param {Object} list\n */\nVue.prototype.setIntoList = function(obj, listName) {\n\tvar listStr = uni.getStorageSync(listName)\n\t// 从本地缓存获取列表名是否存在\n\tvar list;\n\tif (app.isNull(listStr)) {\n\t\t// 为空，赋一个空的list；\n\t\tlist = [];\n\t} else {\n\t\t// 不为空\n\t\tlist = JSON.parse(listStr);\n\t}\n\t// 插入对象到尾部\n\tlist.push(obj);\n\tuni.setStorageSync(listName, JSON.stringify(list));\n}\n/**\n * 把对象添加到列表头部，并储存在缓存里\n * @param {Object} obj\n * @param {Object} listName\n */\nVue.prototype.addIntoList = function(obj, listName) {\n\tvar listStr = uni.getStorageSync(listName)\n\t// 从本地缓存获取列表名是否存在\n\tvar list;\n\tif (app.isNull(listStr)) {\n\t\t// 为空，赋一个空的list；\n\t\tlist = [];\n\t} else {\n\t\t// 不为空\n\t\tlist = JSON.parse(listStr);\n\t}\n\t// 插入对象到头部\n\tlist.unshift(obj);\n\tuni.setStorageSync(listName, JSON.stringify(list));\n}\n/**\n * 从缓存中按名字获取改名列表\n * @param {Object} listName\n */\nVue.prototype.getListByKey = function(listName){\n\tvar listStr = uni.getStorageSync(listName);\n\tvar list;\n\tif (app.isNull(listStr)) {\n\t\t// 为空，赋一个空的list；\n\t\tlist = [];\n\t} else {\n\t\t// 不为空\n\t\tlist = JSON.parse(listStr);\n\t}\n\t\n\treturn list;\n}\n\n\n/** TODO: 可使用 Map 代替 List 提升查询性能（暂时不知道 map 在 uniapp 中怎么写）\n *\t \t\t\t\t\t\t\t\t\t\t\t\t\t\t\tby Jerrio\n * 把该用户信息添加到本地缓存的 userlist 中，如果存在则替换\n * @param {Object} userInfo\n */\nVue.prototype.setUserInfoToUserList = function(userInfo) {\n\tvar userListStr = uni.getStorageSync(\"userList\");\n\tvar userList;\n\tif (app.isNull(userListStr)) {\n\t\t// 为空，赋一个空的list；\n\t\tuserList = [];\n\t} else {\n\t\t// 不为空，查看该用户是否存在\n\t\tvar userList = JSON.parse(userListStr);\n\t\tfor (var i = 0; i < userList.length; i++) {\n\t\t\tvar user = userList[i];\n\t\t\tif (user.id == userInfo.id) {\n\t\t\t\tuserList.splice(i, 1, userInfo); // 替换\n\t\t\t\tuni.setStorageSync(\"userList\", JSON.stringify(userList));\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\t// 用户不存在\n\tuserList.push(userInfo);\n\tuni.setStorageSync(\"userList\", JSON.stringify(userList));\n}\n\n/**\n * 根据 userId，在本地缓存中获取该用户信息\n * @param {Object} userId\n */\nVue.prototype.getUserInfoFromUserList = function(userId) {\n\tvar userListStr = uni.getStorageSync(\"userList\");\n\n\tif (app.isNull(userListStr)) {\n\t\t// 为空，直接返回 null\n\t\treturn null;\n\t} else {\n\t\t// 不为空\n\t\tvar userList = JSON.parse(userListStr);\n\t\tfor (var i = 0; i < userList.length; i++) {\n\t\t\tvar user = userList[i];\n\t\t\tif (user.id == userId) {\n\t\t\t\treturn user;\n\t\t\t}\n\t\t}\n\t}\n\treturn null;\n}\n\n/**\n * 返回页面栈最后一页(当前页面)\n */\nVue.prototype.getCurrentPage = function() {\n\tvar pages = getCurrentPages();\n\tvar currentPage = pages[pages.length - 1];\n\treturn currentPage;\n}\n/**\n * 从服务器查询用户信息, 并拼接额外信息。\n * [需要设置同步否则得不到值，还未测试，暂时弃用，请手动调用myUser拼接]\n */\n// Vue.prototype.myQueryUserInfo = async function(userId) {\n// \tvar that = this;\n// \tvar finalUser;\n// \tuni.request({\n// \t\turl: that.$serverUrl + '/user/queryUser',\n// \t\tmethod: \"POST\",\n// \t\tdata: {\n// \t\t\tuserId: userId\n// \t\t},\n// \t\theader: {\n// \t\t\t'content-type': 'application/x-www-form-urlencoded'\n// \t\t},\n// \t\tsuccess: (res) => {\n// \t\t\t// console.log(res)\n// \t\t\tif (res.data.status == 200) {\n// \t\t\t\t// 3.获取返回的用户信息\n// \t\t\t\tfinalUser = res.data.data;\n// \t\t\t\t// 4.分割邮箱地址, 重构user\n// \t\t\t\tfinalUser = that.myUser(finalUser);\n// \t\t\t}\n// \t\t\tconsole.log(\"里面\");\n// \t\t\tconsole.log(finalUser);\n// \t\t\treturn finalUser;\n// \t\t}\n// \t});\n// \t\n// \t// app.$nextTick(function(){\n// \t// \tconsole.log(finalUser);\n// \t// })\n// \t\n// \t// console.log(\"里面2\");\n// \t// console.log(finalUser);\n// \t// return finalUser;\n// }\n\n/**\n * 分割邮箱地址, 重构user\n * @param {Object} user\n */\nVue.prototype.myUser = function(user) {\n\t// 分割邮箱地址\n\tvar email = user.email;\n\tif (this.isNull(email)) {\n\t\temail = \"[Email]@nottingham.edu.cn\";\n\t}\n\tvar list = email.split('@');\n\tuser.emailPrefix = list[0];\n\tuser.emailSuffix = \"@\" + list[1];\n\n\treturn user\n}\n\nVue.prototype.isNull = function(str) {\n\tif (str == null || str == \"\" || str == undefined) {\n\t\treturn true;\n\t}\n\treturn false;\n}\n\n/**\n * \"\" = true;\n * \" \" = true;\n */\nVue.prototype.isBlank = function(str) {\n\treturn RegExp(/^\\s*$/).test(str);\n}\n\n/**\n * 自定义封装 socket 供全局调用\n * @author: Jerrio\n */\nVue.prototype.mySocket = {\n\n\tisOpen: false,\n\tsocketMsgQueue: [], // 未发送的消息队列\t\n\n\tinit: function() {\n\t\tvar that = this;\n\t\t// 创建websocket长连接\n\t\tuni.connectSocket({\n\t\t\turl: app.$wsServerUrl,\n\t\t\tcomplete: () => {}\n\t\t});\n\n\t\tuni.onSocketOpen(function(res) {\n\t\t\tthat.isOpen = true;\n\t\t\tconsole.log('WebSocket连接已打开！isSocketOpen=' + that.isOpen);\n\t\t\t//发送连接消息，向服务器注册信息\n\t\t\tvar myUserId = app.getGlobalUserInfo().id; // 调用全局用户缓存，需要先请求获取\n\t\t\tif (app.isNull(myUserId)) {\n\t\t\t\tconsole.log(\"请先获取用户数据\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar dataContent = new app.netty.DataContent(app.netty.CONNECT, null, myUserId);\n\t\t\tthat.sendDataContent(dataContent);\n\t\t\t// 发送未发送的信息\n\t\t\tfor (var i = 0; i < that.socketMsgQueue.length; i++) {\n\t\t\t\tif (that.socketMsgQueue[i].action == app.netty.CHAT){\n\t\t\t\t\tthat.sendDataContent(that.socketMsgQueue[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthat.socketMsgQueue = [];\n\n\t\t\t// 签收未签收消息\n\t\t\tapp.chat.fetchUnsignedChatMsg(); // 获取聊天信息\n\t\t\tapp.notification.fetchUnsignedLikeMsg(); // 获取点赞通知\n\t\t\tapp.notification.fetchUnsignedCommentMsg(); // 获取评论通知\n\t\t\t// 定时发送心跳\n\t\t\tsetInterval(that.keepAlive, 50000);\n\t\t});\n\n\t\tuni.onSocketError(function(res) {\n\t\t\tconsole.log('WebSocket连接打开失败，请检查！');\n\t\t});\n\n\t\tuni.onSocketMessage(function(res) {\n\t\t\tvar dataContent = JSON.parse(res.data);\n\t\t\tconsole.log(\"收到服务器内容：\");\n\t\t\tconsole.log(dataContent);\n\t\t\tvar action = dataContent.action;\n\n\t\t\tif (action == app.netty.CHAT \n\t\t\t\t|| action == app.netty.LIKEARTICLE \n\t\t\t\t|| action == app.netty.LIKECOMMENT\n\t\t\t\t|| action == app.netty.COMMENTARTICLE\n\t\t\t\t|| action == app.netty.COMMENTCOMMENT) {\n\t\t\t\t\n\t\t\t\tapp.$store.commit('setMyMsgCount'); // 累加 msgCount in index.js\n\t\t\t\t\n\t\t\t\tswitch (action){\n\t\t\t\t\tcase app.netty.CHAT: // 如果消息类型为 CHAT\n\t\t\t\t\t\tvar chatMessage = dataContent.data;\n\t\t\t\t\t\t// 发送签收消息\n\t\t\t\t\t\tthat.signMsgList(chatMessage.msgId);\n\t\t\t\t\t\t\n\t\t\t\t\t\t// 保存聊天历史记录到本地缓存\n\t\t\t\t\t\tvar myId = chatMessage.receiverId;\n\t\t\t\t\t\tvar friendId = chatMessage.senderId;\n\t\t\t\t\t\tvar msg = chatMessage.msg;\n\t\t\t\t\t\tvar createDate = app.formatTime(chatMessage.createDate); // 对时间戳进行格式化\n\t\t\t\t\t\t\n\t\t\t\t\t\tapp.chat.saveUserChatHistory(myId, friendId, msg, app.chat.FRIEND, createDate);\n\t\t\t\t\t\t\n\t\t\t\t\t\t// 判断当前页面，保存聊天快照\n\t\t\t\t\t\tvar page = app.getCurrentPage();\n\t\t\t\t\t\tif (page.route == 'pages/chatpage/chatpage') {\n\t\t\t\t\t\t\tvar pageFriendId = page.data.friendInfo.id; // 打开页面才有对象，越层判断会报对象为空的错\n\t\t\t\t\t\t\t/* \n\t\t\t\t\t\t\t【BUG】ISO 虚拟机获取 friendInfo.id 报错信息：\n\t\t\t\t\t\t\t undefined is not an object (evaluating 'page.data.friendInfo.id')\n\t\t\t\t\t\t\t 不知道真机会不会有这种情况\n\t\t\t\t\t\t\t*/\n\t\t\t\t\t\t\t// var pagestr = JSON.stringify(page.data);\n\t\t\t\t\t\t\t// console.log(pagestr);\n\t\t\t\t\t\t\tif (pageFriendId == friendId) {\n\t\t\t\t\t\t\t\t// 与该用户在聊天，标记为已读\n\t\t\t\t\t\t\t\tconsole.log(\"与该用户在聊天，标记为已读\");\n\t\t\t\t\t\t\t\tapp.chat.saveUserChatSnapshot(myId, friendId, msg, app.chat.READ, createDate);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// 修改 store，发送信号，把消息卡片渲染到对话窗口 和 消息列表\n\t\t\t\t\t\t\t\tvar newMessage = new app.chat.ChatHistory(myId, friendId, msg, app.chat.FRIEND, createDate);\n\t\t\t\t\t\t\t\tapp.$store.commit('setChatMessageCard', newMessage);\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t//不是与该用户聊天，标记为未读\n\t\t\t\t\t\t\t\tconsole.log(\"不是与该用户聊天，标记为未读\");\n\t\t\t\t\t\t\t\tapp.chat.saveUserChatSnapshot(myId, friendId, msg, app.chat.UNREAD, createDate);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// 聊天页面未打开，标记为未读\n\t\t\t\t\t\t\tconsole.log(\"聊天页面未打开，标记为未读\");\n\t\t\t\t\t\t\tapp.chat.saveUserChatSnapshot(myId, friendId, msg, app.chat.UNREAD, createDate);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase app.netty.LIKEARTICLE:\n\t\t\t\t\t\tconsole.log(\"获取点赞文章\");\n\t\t\t\t\t\t// 签收消息\n\t\t\t\t\t\tthat.signLikeArticleList(dataContent.data.source.id);\n\t\t\t\t\t\t// 存入缓存 (TODO：登陆时获取未签收点赞消息)\n\t\t\t\t\t\tdataContent.data.source.createDate = app.formatTime(dataContent.data.source.createDate);\n\t\t\t\t\t\tapp.notification.saveLikeMsg(dataContent);\n\t\t\t\t\t\tapp.$store.commit('setLikeMsgCount');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase app.netty.LIKECOMMENT:\n\t\t\t\t\t\tconsole.log(\"获取点赞评论\");\n\t\t\t\t\t\t// 签收消息\n\t\t\t\t\t\tthat.signLikeCommentList(dataContent.data.source.id);\n\t\t\t\t\t\t// 存入缓存\n\t\t\t\t\t\tdataContent.data.source.createDate = app.formatTime(dataContent.data.source.createDate);\n\t\t\t\t\t\tapp.notification.saveLikeMsg(dataContent);\n\t\t\t\t\t\tapp.$store.commit('setLikeMsgCount');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase app.netty.COMMENTARTICLE:\n\t\t\t\t\t\tconsole.log(\"获取评论文章\");\n\t\t\t\t\t\t// 签收消息\n\t\t\t\t\t\tthat.signCommentList(dataContent.data.source.id);\n\t\t\t\t\t\t// 存入缓存\n\t\t\t\t\t\tdataContent.data.source.createDate = app.formatTime(dataContent.data.source.createDate);\n\t\t\t\t\t\tapp.notification.saveCommentMsg(dataContent);\n\t\t\t\t\t\tapp.$store.commit('setCommentMsgCount');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase app.netty.COMMENTCOMMENT:\n\t\t\t\t\t\tconsole.log(\"获取评论评论\");\n\t\t\t\t\t\t// 签收消息\n\t\t\t\t\t\tthat.signCommentList(dataContent.data.source.id);\n\t\t\t\t\t\t// 存入缓存\n\t\t\t\t\t\tdataContent.data.source.createDate = app.formatTime(dataContent.data.source.createDate);\n\t\t\t\t\t\tapp.notification.saveCommentMsg(dataContent);\n\t\t\t\t\t\tapp.$store.commit('setCommentMsgCount');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tuni.onSocketClose(function(res) {\n\t\t\tthat.isOpen = false;\n\t\t\tconsole.log('WebSocket 已关闭！isSocketOpen=' + that.isOpen);\n\t\t\t// 三秒一次重连\n\t\t\tconsole.log(\"重连中..\");\n\t\t\tsetTimeout(function() {\n\t\t\t\tthat.init();\n\t\t\t}, 3000);\n\t\t});\n\n\t},\n\t/**\n\t * 向 netty 服务器发送 聊天信息的方法 sendChatObj\n\t * @param {Object} type\n\t * @param {Object} toUserId\n\t * @param {Object} msg\n\t * @param {Object} extand\n\t */\n\tsendObj(action, toUserId, msg, extand) {\n\t\tvar myUserId = app.getGlobalUserInfo().id; // 调用全局用户缓存，需要先请求获取\n\t\tif (app.isNull(myUserId)) {\n\t\t\tconsole.log(\"请先获取用户数据\");\n\t\t\treturn;\n\t\t}\n\n\t\t// 获取当前时间戳，传输时间戳\n\t\tvar timeStamp = new Date().getTime();\n\n\t\t// 构建载体\n\t\tvar chatMessage = new app.netty.ChatMessage(myUserId, toUserId, msg, null, timeStamp);\n\t\tvar dataContent = new app.netty.DataContent(action, chatMessage, extand);\n\n\t\tvar isSocketOpen = app.mySocket.isOpen;\n\t\tif (isSocketOpen == true) {\n\t\t\tthis.sendDataContent(dataContent);\n\t\t} else {\n\t\t\t// 加到待发送列表\n\t\t\tconsole.log(\"isSocketOpen=\" + isSocketOpen);\n\t\t\tthis.socketMsgQueue.push(dataContent);\n\t\t\tconsole.log(this.socketMsgQueue);\n\t\t}\n\t},\n\t\n\t/**\n\t * 向 netty 服务器发送 DataConten 对象\n\t * @param {Object} dataContent\n\t */\n\tsendDataContent(dataContent) {\n\t\tvar data = JSON.stringify(dataContent);\n\t\tuni.sendSocketMessage({\n\t\t\tdata: data,\n\t\t});\n\t\t\n\t\tif (dataContent.action == app.netty.CHAT) {\n\t\t\t// 保存聊天历史到本地缓存，保存聊天快照到本地\n\t\t\tvar chatMessage = dataContent.data;\n\t\t\tvar createDate = app.formatTime(chatMessage.createDate);\n\t\t\t\n\t\t\t// console.log(\"发消息的时间戳：\" + createDate);\n\t\t\tapp.chat.saveUserChatHistory(chatMessage.senderId, \n\t\t\t\t\t\t\t\t\t\t chatMessage.receiverId, \n\t\t\t\t\t\t\t\t\t\t chatMessage.msg, \n\t\t\t\t\t\t\t\t\t\t app.chat.ME, \n\t\t\t\t\t\t\t\t\t\t createDate);\n\t\t\tapp.chat.saveUserChatSnapshot(chatMessage.senderId, \n\t\t\t\t\t\t\t\t\t\t  chatMessage.receiverId, \n\t\t\t\t\t\t\t\t\t\t  chatMessage.msg, \n\t\t\t\t\t\t\t\t\t\t  app.chat.READ, \n\t\t\t\t\t\t\t\t\t\t  createDate);\n\t\t\t// 刷到对话窗口\n\t\t\tapp.$store.commit('doFlashChatPage');\n\t\t}\n\t},\n\n\t/**\n\t * 批量签收聊天消息\n\t * @param {Object} msgIds\n\t */\n\tsignMsgList(msgIds) {\n\t\tvar dataContent = new app.netty.DataContent(app.netty.SIGNED, null, msgIds);\n\t\tthis.sendDataContent(dataContent);\n\t},\n\t\n\t/**\n\t * 批量签收点赞文章消息\n\t * @param {Object} msgIds\n\t */\n\tsignLikeArticleList(msgIds) {\n\t\tvar dataContent = new app.netty.DataContent(app.netty.LIKEARTICLE_SIGN, null, msgIds);\n\t\tthis.sendDataContent(dataContent);\n\t},\n\t\n\t/**\n\t * 批量签收点赞评论消息\n\t * @param {Object} msgIds\n\t */\n\tsignLikeCommentList(msgIds) {\n\t\tvar dataContent = new app.netty.DataContent(app.netty.LIKECOMMENT_SIGN, null, msgIds);\n\t\tthis.sendDataContent(dataContent);\n\t},\n\t\n\t/**\n\t * 批量签收评论消息\n\t * @param {Object} msgIds\n\t */\n\tsignCommentList(msgIds) {\n\t\tvar dataContent = new app.netty.DataContent(app.netty.COMMENT_SIGN, null, msgIds);\n\t\tthis.sendDataContent(dataContent);\n\t},\n\n\t/**\n\t * 发送心跳\n\t */\n\tkeepAlive() {\n\t\t// 用 setInterval 调用时，使用 this 获取不到实例，故用 app\n\t\tvar dataContent = new app.netty.DataContent(app.netty.KEEPALIVE, null, null);\n\t\tapp.mySocket.sendDataContent(dataContent);\n\t},\n}\n\nVue.prototype.chat = {\n\n\tME: 1, // 我的消息-右边\n\tFRIEND: 2, // 对方消息-左边\n\tREAD: 3,\n\tUNREAD: 4,\n\t/**\n\t * 历史记录对象\n\t * @param {Object} myId\n\t * @param {Object} friendId\n\t * @param {Object} msg\n\t * @param {Object} flag 是我的消息还是朋友的消息\n\t * @param {Object} createDate\n\t */\n\tChatHistory: function(myId, friendId, msg, flag, createDate) {\n\t\tthis.myId = myId;\n\t\tthis.friendId = friendId;\n\t\tthis.msg = msg;\n\t\tthis.flag = flag;\n\t\tthis.createDate = createDate;\n\t},\n\n\t/**\n\t * 快照对象\n\t * @param {Object} myId\n\t * @param {Object} friendId\n\t * @param {Object} msg\n\t * @param {Object} isRead 用于判断消息是已读还是未读\n\t * @param {Object} createDate\n\t */\n\tChatSnapshot: function(myId, friendId, msg, isRead, createDate) {\n\t\tthis.myId = myId;\n\t\tthis.friendId = friendId;\n\t\tthis.msg = msg;\n\t\tthis.isRead = isRead;\n\t\tthis.createDate = createDate;\n\t},\n\t/**\n\t * 保存用户的聊天记录\n\t * @param {Object} myId\n\t * @param {Object} friendId\n\t * @param {Object} msg\n\t * @param {Object} flag 判断本条消息是谁发送的, 1：我 2：朋友\n\t * @param {Object} createDate\n\t */\n\tsaveUserChatHistory: function(myId, friendId, msg, flag, createDate) {\n\n\t\tvar chatKey = \"chat-\" + myId + \"-\" + friendId;\n\t\t// 从本地缓存获取聊天记录是否存在\n\t\tvar chatHistoryListStr = uni.getStorageSync(chatKey);\n\t\tvar chatHistoryList;\n\t\tif (app.isNull(chatHistoryListStr)) {\n\t\t\t// 为空，赋一个空的list；\n\t\t\tchatHistoryList = [];\n\t\t} else {\n\t\t\t// 不为空\n\t\t\tchatHistoryList = JSON.parse(chatHistoryListStr);\n\t\t}\n\n\t\t// 构建聊天记录对象\n\t\tvar singleMsg = new this.ChatHistory(myId, friendId, msg, flag, createDate);\n\n\t\t// 添加到list尾部\n\t\tchatHistoryList.push(singleMsg);\n\n\t\tuni.setStorageSync(chatKey, JSON.stringify(chatHistoryList));\n\n\t},\n\t\n\t/**\n\t * 分页获取聊天历史，从列表尾部开始读取(反取)\n\t * @param {Object} myId\n\t * @param {Object} friendId\n\t * @param {Object} page\n\t */\n\tgetUserChatHistory: function(myId, friendId, page) {\n\t\tvar chatKey = \"chat-\" + myId + \"-\" + friendId;\n\t\tvar list = app.getListByKey(chatKey).reverse();\n\t\tvar size = 20;\n\t\tvar start = (page-1) * size;\n\t\tvar newList = [];\n\t\tif (list.length < start){\n\t\t\treturn null;\n\t\t}else{\n\t\t\tfor (var i=0; i<size; i++){\n\t\t\t\tif(!app.isNull(list[start+i])){\n\t\t\t\t\tnewList.unshift(list[start+i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn newList;\n\t\t}\n\t},\n\t\n\t/**\n\t * 删除我和朋友的聊天记录\n\t * @param {Object} myId\n\t * @param {Object} friendId\n\t */\n\tdeletUserChatHistory: function(myId, friendId) {\n\t\tvar chatKey = \"chat-\" + myId + \"-\" + friendId;\n\t\tuni.removeStorageSync(chatKey);\n\t},\n\n\t/**\n\t * 聊天记录快照，仅保存每次和朋友聊天的最后一条消息\n\t * @param {Object} myId\n\t * @param {Object} friendId\n\t * @param {Object} msg\n\t * @param {Object} isRead\n\t * @param {Object} createDate\n\t */\n\tsaveUserChatSnapshot: function(myId, friendId, msg, isRead, createDate) {\n\n\t\tvar chatKey = \"chat-snapshot\" + myId;\n\n\t\t// 从本地缓存获取聊天快照的 list\n\t\tvar chatSnapshotListStr = uni.getStorageSync(chatKey);\n\t\tvar chatSnapshotList;\n\t\tif (app.isNull(chatSnapshotListStr)) {\n\t\t\t// 为空，赋一个空的list；\n\t\t\tchatSnapshotList = [];\n\t\t} else {\n\t\t\t// 不为空\n\t\t\tchatSnapshotList = JSON.parse(chatSnapshotListStr);\n\t\t\t// 循环快照list，删除含 friendId 的项\n\t\t\tfor (var i = 0; i < chatSnapshotList.length; i++) {\n\t\t\t\tif (chatSnapshotList[i].friendId == friendId) {\n\t\t\t\t\tchatSnapshotList.splice(i, 1); // 从i项往后删，只删一个\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// 构建聊天快照对象\n\t\tvar singleMsg = new this.ChatSnapshot(myId, friendId, msg, isRead, createDate);\n\t\t// 添加到 list 第一项\n\t\tchatSnapshotList.unshift(singleMsg);\n\n\t\tuni.setStorageSync(chatKey, JSON.stringify(chatSnapshotList));\n\t},\n\n\t/**\n\t * 获取用户快照记录列表\n\t */\n\tgetUserChatSnapShot: function(myId) {\n\t\tvar chatKey = \"chat-snapshot\" + myId;\n\n\t\t// 从本地缓存获取聊天快照的 list\n\t\tvar chatSnapshotListStr = uni.getStorageSync(chatKey);\n\t\tvar chatSnapshotList;\n\t\tif (app.isNull(chatSnapshotListStr)) {\n\t\t\t// 为空，赋一个空的list；\n\t\t\tchatSnapshotList = [];\n\t\t} else {\n\t\t\t// 不为空\n\t\t\tchatSnapshotList = JSON.parse(chatSnapshotListStr);\n\t\t}\n\n\t\treturn chatSnapshotList;\n\t},\n\n\t/**\n\t * 删除与该用户的聊天快照记录\n\t * @param {Object} myId\n\t * @param {Object} friendId\n\t */\n\tdeletUserChatSnapShot: function(myId, friendId) {\n\t\tvar chatKey = \"chat-snapshot\" + myId;\n\t\t// 从本地缓存获取聊天快照的 list\n\t\tvar chatSnapshotListStr = uni.getStorageSync(chatKey);\n\t\tvar chatSnapshotList;\n\t\tif (app.isNull(chatSnapshotListStr)) {\n\t\t\t// 为空，不作处理\n\t\t\treturn;\n\t\t} else {\n\t\t\t// 不为空\n\t\t\tchatSnapshotList = JSON.parse(chatSnapshotListStr);\n\t\t\t// 循环快照list，删除含 friendId 的项\n\t\t\tfor (var i = 0; i < chatSnapshotList.length; i++) {\n\t\t\t\tif (chatSnapshotList[i].friendId == friendId) {\n\t\t\t\t\tchatSnapshotList.splice(i, 1); // 从i项往后删，只删一个\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tuni.setStorageSync(chatKey, JSON.stringify(chatSnapshotList));\n\t},\n\n\t/**\n\t * 把快照标记为已读，并且不改变在列表中的位置\n\t * @param {Object} myId\n\t * @param {Object} friendId\n\t */\n\treadUserChatSnapShot: function(myId, friendId) {\n\t\tvar chatKey = \"chat-snapshot\" + myId;\n\n\t\t// 从本地缓存获取聊天快照的 list\n\t\tvar chatSnapshotListStr = uni.getStorageSync(chatKey);\n\t\tvar chatSnapshotList;\n\t\tif (app.isNull(chatSnapshotListStr)) {\n\t\t\t// 为空，赋一个空的list；\n\t\t\treturn;\n\t\t} else {\n\t\t\t// 不为空\n\t\t\tchatSnapshotList = JSON.parse(chatSnapshotListStr);\n\t\t\t// 删除快照对象并放入新的在原有位置\n\t\t\tfor (var i = 0; i < chatSnapshotList.length; i++) {\n\t\t\t\tvar item = chatSnapshotList[i];\n\t\t\t\tif (item.friendId == friendId) {\n\t\t\t\t\titem.isRead = this.READ;\n\t\t\t\t\tchatSnapshotList.splice(i, 1, item); // 替换\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tuni.setStorageSync(chatKey, JSON.stringify(chatSnapshotList));\n\t\t}\n\t},\n\n\tfetchUnsignedChatMsg: function() {\n\t\tvar user = app.getGlobalUserInfo();\n\t\tvar msgIds = \",\" // 格式: ,1001,1002,1003,\n\t\tvar that = this;\n\t\tuni.request({\n\t\t\turl: app.$serverUrl + '/user/getUnsignedMsg',\n\t\t\tmethod: \"POST\",\n\t\t\tdata: {\n\t\t\t\tuserId: user.id\n\t\t\t},\n\t\t\theader: {\n\t\t\t\t'content-type': 'application/x-www-form-urlencoded'\n\t\t\t},\n\t\t\tsuccess: (res) => {\n\t\t\t\t// console.log(res)\n\t\t\t\tif (res.data.status == 200) {\n\t\t\t\t\tvar unsignedMsgList = res.data.data;\n\t\t\t\t\tconsole.log(unsignedMsgList);\n\t\t\t\t\tif (!app.isNull(unsignedMsgList)) {\n\t\t\t\t\t\tapp.$store.commit('setMyMsgCount', unsignedMsgList.length); // 增加 msgCount in index.js\n\t\t\t\t\t\tfor (var i = 0; i < unsignedMsgList.length; i++) {\n\t\t\t\t\t\t\tvar msgObj = unsignedMsgList[i];\n\t\t\t\t\t\t\tvar timeStamp = new Date(msgObj.createDate).getTime();\n\t\t\t\t\t\t\tvar createDate = app.formatTime(timeStamp);\n\t\t\t\t\t\t\t// 1.逐条存入聊天记录\n\t\t\t\t\t\t\tthis.saveUserChatHistory(msgObj.acceptUserId,\n\t\t\t\t\t\t\t\tmsgObj.sendUserId,\n\t\t\t\t\t\t\t\tmsgObj.msg,\n\t\t\t\t\t\t\t\tthis.FRIEND,\n\t\t\t\t\t\t\t\tcreateDate);\n\t\t\t\t\t\t\t// 2.保存聊天快照到本地\n\t\t\t\t\t\t\tthis.saveUserChatSnapshot(msgObj.acceptUserId,\n\t\t\t\t\t\t\t\tmsgObj.sendUserId,\n\t\t\t\t\t\t\t\tmsgObj.msg,\n\t\t\t\t\t\t\t\tthis.UNREAD,\n\t\t\t\t\t\t\t\tcreateDate);\n\t\t\t\t\t\t\t// 3.拼接批量签收id的字符串\n\t\t\t\t\t\t\tmsgIds += msgObj.id + \",\";\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// 调用批量签收方法\n\t\t\t\t\t\tapp.mySocket.signMsgList(msgIds);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\n/**\n * 点赞评论通知\n */\nVue.prototype.notification={\t\n\tLIKEMSG_KEY : \"likeMsg\" + app.getGlobalUserInfo().id,\n\tCOMMENTMSG_KEY : \"commentMsg\" + app.getGlobalUserInfo().id,\n\t/**\n\t * 把点赞通知存入缓存\n\t * @param {Object} dataContent\n\t */\n\tsaveLikeMsg(dataContent){\n\t\tapp.addIntoList(dataContent, this.LIKEMSG_KEY);\n\t},\n\t\n\tgetLikeMsg(page){\n\t\tvar size = 10;\n\t\tvar list = app.getListByKey(this.LIKEMSG_KEY);\n\t\tvar start = (page-1) * size;\n\t\tvar newList = [];\n\t\tif (list.length < start){\n\t\t\treturn null;\n\t\t}else{\n\t\t\tfor (var i=0; i<size; i++){\n\t\t\t\tif(!app.isNull(list[start+i])){\n\t\t\t\t\tnewList.push(list[start+i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn newList;\n\t\t}\n\t},\n\t\n\t/**\n\t * 把评论通知存入缓存\n\t * @param {Object} dataContent\n\t */\n\tsaveCommentMsg(dataContent){\n\t\tapp.addIntoList(dataContent, this.COMMENTMSG_KEY);\n\t},\n\t\n\tgetCommentMsg(page){\n\t\tvar size = 10;\n\t\tvar list = app.getListByKey(this.COMMENTMSG_KEY);\n\t\tvar start = (page-1) * size;\n\t\tvar newList = [];\n\t\tif (list.length < start){\n\t\t\treturn null;\n\t\t}else{\n\t\t\tfor (var i=0; i<size; i++){\n\t\t\t\tif(!app.isNull(list[start+i])){\n\t\t\t\t\tnewList.push(list[start+i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn newList;\n\t\t}\n\t},\n\t\n\t/**\n\t * 获取并签收未签收的点赞通知\n\t */\n\tfetchUnsignedLikeMsg(){\n\t\tvar user = app.getGlobalUserInfo();\n\t\tvar likeArticleIds = \",\" // 格式: ,1001,1002,1003,\n\t\tvar likeCommentIds = \",\"\n\t\tvar that = this;\n\t\tuni.request({\n\t\t\turl: app.$serverUrl + '/article/getUnsignedLikeMsg',\n\t\t\tmethod: \"POST\",\n\t\t\tdata: {\n\t\t\t\tuserId: user.id\n\t\t\t},\n\t\t\theader: {\n\t\t\t\t'content-type': 'application/x-www-form-urlencoded'\n\t\t\t},\n\t\t\tsuccess: (res) => {\n\t\t\t\t// console.log(res)\n\t\t\t\tif (res.data.status == 200) {\n\t\t\t\t\tvar unsignedMsgList = res.data.data;\n\t\t\t\t\tconsole.log(unsignedMsgList);\n\t\t\t\t\tif (!app.isNull(unsignedMsgList)) {\n\t\t\t\t\t\tfor (var i = 0; i < unsignedMsgList.length; i++) {\n\t\t\t\t\t\t\tvar dataContent = unsignedMsgList[i];\n\t\t\t\t\t\t\t//累加信息\n\t\t\t\t\t\t\tapp.$store.commit('setMyMsgCount'); // 累加通用信息\n\t\t\t\t\t\t\tapp.$store.commit('setLikeMsgCount'); //累加点赞信息\n\t\t\t\t\t\t\t// 逐条存入缓存\n\t\t\t\t\t\t\tdataContent.data.source.createDate = app.formatTime(dataContent.data.source.createDate);\n\t\t\t\t\t\t\tapp.notification.saveLikeMsg(dataContent);\n\t\t\t\t\t\t\t// 拼接批量签收id的字符串\n\t\t\t\t\t\t\tswitch (dataContent.action){\n\t\t\t\t\t\t\t\tcase app.netty.LIKEARTICLE:\n\t\t\t\t\t\t\t\t\tlikeArticleIds += dataContent.data.source.id + \",\";\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase app.netty.LIKECOMMENT:\n\t\t\t\t\t\t\t\t\tlikeCommentIds += dataContent.data.source.id + \",\";\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\n\t\t\t\t\t\t// 调用批量签收方法\n\t\t\t\t\t\tapp.mySocket.signLikeArticleList(likeArticleIds);\n\t\t\t\t\t\tapp.mySocket.signLikeCommentList(likeCommentIds);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\t\n\t/**\n\t * 获取并签收未签收的评论通知\n\t */\n\tfetchUnsignedCommentMsg(){\n\t\tvar user = app.getGlobalUserInfo();\n\t\tvar commentIds = \",\" // 格式: ,1001,1002,1003,\n\t\tvar that = this;\n\t\tuni.request({\n\t\t\turl: app.$serverUrl + '/article/getUnsignedCommentMsg',\n\t\t\tmethod: \"POST\",\n\t\t\tdata: {\n\t\t\t\tuserId: user.id\n\t\t\t},\n\t\t\theader: {\n\t\t\t\t'content-type': 'application/x-www-form-urlencoded'\n\t\t\t},\n\t\t\tsuccess: (res) => {\n\t\t\t\t// console.log(res)\n\t\t\t\tif (res.data.status == 200) {\n\t\t\t\t\tvar unsignedMsgList = res.data.data;\n\t\t\t\t\tconsole.log(unsignedMsgList);\n\t\t\t\t\tif (!app.isNull(unsignedMsgList)) {\n\t\t\t\t\t\tfor (var i = 0; i < unsignedMsgList.length; i++) {\n\t\t\t\t\t\t\tvar dataContent = unsignedMsgList[i];\n\t\t\t\t\t\t\t//累加信息\n\t\t\t\t\t\t\tapp.$store.commit('setMyMsgCount'); // 累加通用信息\n\t\t\t\t\t\t\tapp.$store.commit('setCommentMsgCount'); //累加评论信息\n\t\t\t\t\t\t\t// 逐条存入缓存\n\t\t\t\t\t\t\tdataContent.data.source.createDate = app.formatTime(dataContent.data.source.createDate);\n\t\t\t\t\t\t\tapp.notification.saveCommentMsg(dataContent);\n\t\t\t\t\t\t\t// 拼接批量签收id的字符串\n\t\t\t\t\t\t\tcommentIds += dataContent.data.source.id + \",\";\n\t\t\t\t\t\t}\n\t\t\n\t\t\t\t\t\t// 调用批量签收方法\n\t\t\t\t\t\tapp.mySocket.signCommentList(commentIds);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nVue.prototype.netty = {\n\t/**\n\t * 和后端的枚举对应\n\t */\n\tCONNECT: 1, \t\t\t// 第一次(或重连)初始化连接\n\tCHAT: 2,\t\t\t\t// 聊天消息\n\tSIGNED: 3, \t\t\t\t// 消息签收\n\tKEEPALIVE: 4, \t\t\t// 客户端保持心跳\n\tLIKEARTICLE: 5, \t\t// 点赞文章通知\n\tLIKECOMMENT: 6, \t\t// 点赞评论通知\n\tCOMMENTARTICLE: 7, \t\t// 评论文章通知\n\tCOMMENTCOMMENT: 8,\t\t// 评论评论通知\n\tLIKEARTICLE_SIGN: 9, \t// 签收点赞文章通知\n\tLIKECOMMENT_SIGN: 10, \t// 签收点赞评论通知\n\tCOMMENT_SIGN: 11, \t\t// 签收评论文章通知\n\n\t/**\n\t * 和后端 ChatMessage 聊天模型的对象保持一致\n\t * @param {Object} senderId\n\t * @param {Object} receiverId\n\t * @param {Object} msg\n\t * @param {Object} msgId\n\t * @param {Object} createDate\n\t */\n\tChatMessage: function(senderId, receiverId, msg, msgId, createDate) {\n\t\tthis.senderId = senderId;\n\t\tthis.receiverId = receiverId;\n\t\tthis.msg = msg;\n\t\tthis.msgId = msgId; // 前端发送设置null就好\n\t\tthis.createDate = createDate;\n\t},\n\t\n\t/**\n\t * 构建消息 DataContent 模型对象\n\t * @param {Object} action\n\t * @param {Object} data\n\t * @param {Object} extand\n\t */\n\tDataContent: function(action, data, extand) {\n\t\tthis.action = action;\n\t\tthis.data = data;\n\t\tthis.extand = extand;\n\t},\n}\n\n/**\n * 格式化时间戳\n * @param {Object} timeStamp\n */\nVue.prototype.formatTime = function(timeStamp) {\n\t// 将/[0-9]/位的数字编成/0[0-9]/  \n\n\tif (timeStamp.length < 13) {\n\t\ttimeStamp += \"000\";\n\t}\n\tvar d = new Date(parseInt(timeStamp));\n\n\tvar year = d.getFullYear();\n\tvar month = this.getTwo(d.getMonth() + 1);\n\tvar date = this.getTwo(d.getDate());\n\tvar hour = this.getTwo(d.getHours());\n\tvar minute = this.getTwo(d.getMinutes());\n\tvar second = this.getTwo(d.getSeconds());\n\t\n\treturn month + \"/\" + date + \" \" + hour + \":\" + minute;\n\t// 明年改加上年的逻辑 鸣谦说的...\n\t// return year + \"/\" + month + \"/\" + date + \" \" + hour + \":\" + minute + \":\" + second;\n}\n\nVue.prototype.getTwo = function(s) {\n\tif (parseInt(s) < 10) {\n\t\treturn \"0\" + s;\n\t} else {\n\t\treturn \"\" + s;\n\t}\n}\n\n/**\n * Timestamp 渲染\n * @param {Object} timediff\n */\nVue.prototype.timeDeal = function(timediff) {\n\tconsole.log(timediff);\n\ttimediff = new Date(timediff);\n\tconsole.log(timediff);\n\tvar parts = [timediff.getFullYear(), timediff.getMonth(), timediff.getDate(), timediff.getHours(), timediff.getMinutes(),\n\t\ttimediff.getSeconds()\n\t];\n\tvar oldTime = timediff.getTime();\n\tvar now = new Date();\n\tvar newTime = now.getTime();\n\tvar milliseconds = 0;\n\tvar timeSpanStr;\n\tmilliseconds = newTime - oldTime;\n\tif (milliseconds <= 1000 * 60 * 1) {\n\t\ttimeSpanStr = '刚刚';\n\t} else if (1000 * 60 * 1 < milliseconds && milliseconds <= 1000 * 60 * 60) {\n\t\ttimeSpanStr = Math.round((milliseconds / (1000 * 60))) + '分钟前';\n\t} else if (1000 * 60 * 60 * 1 < milliseconds && milliseconds <= 1000 * 60 * 60 * 24) {\n\t\ttimeSpanStr = Math.round(milliseconds / (1000 * 60 * 60)) + '小时前';\n\t} else if (1000 * 60 * 60 * 24 < milliseconds && milliseconds <= 1000 * 60 * 60 * 24 * 15) {\n\t\ttimeSpanStr = Math.round(milliseconds / (1000 * 60 * 60 * 24)) + '天前';\n\t\t\n\t} else if (milliseconds > 1000 * 60 * 60 * 24 * 15 && parts[0] == now.getFullYear()) {\n\t\ttimeSpanStr = parts[1] + '-' + parts[2] + ' ' + parts[3] + ':' + parts[4];\n\t} else {\n\t\ttimeSpanStr = parts[0] + '-' + parts[1] + '-' + parts[2] + ' ' + parts[3] + ':' + parts[4];\n\t}\n\treturn timeSpanStr;\n}\n\n// 封装tabbar索引，避免重复书写\nVue.mixin({\n  methods:{\n    setTabBarIndex(index){\n      if (typeof this.$mp.page.getTabBar === 'function' &&\n        this.$mp.page.getTabBar()) {\n        this.$mp.page.getTabBar().setData({\n          selected:index\n        })\n      }\n    }\n  }\n})","var render, staticRenderFns\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('55314984', component.options)\n    } else {\n      api.reload('55314984', component.options)\n    }\n    \n  }\n}\ncomponent.options.__file = \"Users/jerrio/Desktop/JumboX/诺圈/Nuoquan/nuoquan-client/App.vue\"\nexport default component.exports","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./App.vue?vue&type=script&lang=js&\"","\nexport default {\n\tonLaunch: function() {\n\t\tconsole.log('App Launch')\n\t},\n\tonShow: function() {\n\t\tconsole.log('App Show')\n\t},\n\tonHide: function() {\n\t\tconsole.log('App Hide')\n\t},\n\n}\n","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./App.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./App.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin"],"sourceRoot":""}
>>>>>>> master
